*          DATA SET CBT1016N   AT LEVEL 001 AS OF 05/02/89
*          DATA SET CBT1016    AT LEVEL 001 AS OF 11/05/87              00001
*          DATA SET CBT1016    AT LEVEL 001 AS OF 06/16/82              00002
*                                                                       00003
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00004
*      CBT1016  MODIFICATION HISTORY --- CHANGES MADE BY CBT          * 00005
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00006
*                                                                     * 00007
*  06-16-82  P.E.DUBREUIL                                             * 00008
*  INCREASE MAXCYL EQUATE TO 887 FOR 3380 SUPPORT                     * 00009
*                                                                     * 00010
*  09-25-84  LAUREEN BEAUCHAINE                               LMB-CBT * 00011
*  UPDATED TO RUN UNDER X-A + SP. THE IOSB MAY BE ABOVE THE   LMB-CBT * 00012
*  16 MEG LINE, SO YOU MUST BE IN 31 BIT AMODE.                       * 00013
*                                                                     * 00014
*  11-29-85  CP WARE                                                  * 00015
*  INCREASE MAXCYL EQUATE TO 1772 FOR 3380E SUPPORT                   * 00016
*                                                                     * 00017
*  11-03-87  ARNIE C.                                                 * 00018
*  INCREASE MAXCYL EQUATE TO 2656 FOR 3380K SUPPORT                   * 00019
*                                                                     * 00020
*  11-05-87  L. NOVAK                                                 * 00021
*  CONVERTED PROGRAM TO SUPPORT 3380K'S.                     LMN-CBT  * 00022
*                                                                     * 00023
*  04-04-89  R TANSKY                                                 * 00024
*  FIXED BUG THAT MAPPED CATALOG PACK                        R.T.     * 00025
*                                                                     * 00026
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00027
*                                                                       00028
* THIS MUST BE LINKED AS AC=1                                           00029
*                                                                       00030
* SAMPLE PROC                                                           00031
*                                                                       00032
* SMAP     PROC NAME=,SO=1,U='SYSALLDA',COPY=1                          00033
* SMAP     EXEC PGM=CBT1016,PARM=SMAP,REGION=1024K                      00034
* VOLUME01 DD VOL=SER=&NAME,DISP=SHR,UNIT=&U                            00035
* SYSPRINT DD SYSOUT=&SO,COPIES=&COPY                                   00036
* SYSSEEK  DD DUMMY,DCB=BLKSIZE=121                                     00037
*                                                                       00038
*         STEPNAME SETS NUMBER OF SAMPLES FOR "SMAP"                    00039
*                                                                       00040
*         STEPNAME FORMAT IS AS FOLLOWS -                               00041
*                                                                       00042
*         SNNNN -                                                       00043
*                  "NNNN"  IS THE NO. OF 1/5 SEC SAMPLES.               00044
*                  IF "NNNN" IS NOT NUMERIC A DEFAULT OF                00045
*                  3000 SAMPLES WILL BE USED (10 MINUTES)               00046
*                                                                       00047
*   NOTE: IF YOU WANT TO CHANGE THE NUMBER OF SAMPLES                   00048
*         AND YOU HAVE A PROC IN SYS1.PROCLIB THAT YOU START FROM       00049
*         THE CONSOLE THE WAY TO DO IT IS:                              00050
*                                                                       00051
*           S SMAP.SNNNN,NAME=SYSRES                                    00052
*                                                                       00053
DISKSEEK TITLE '... MACROS NOT FOUND IN SYS1.AMODGEN....'               00054
         MACRO                                                          00055
         IEZCOM                                                         00056
COMECBPT DS    F    ADDRESS OF THE ECB FOR STARTED TASK                 00057
COMCIBPT DS    F    ADDRESS OF THE START OF THE CIB CHAIN FOR THIS TASK 00058
         MEND                                                           00059
         SPACE 3                                                        00060
         MACRO                                                          00061
         IEZCIB                                                         00062
         DS    0D                                                       00063
CIBNEXT  DS    A    NEXT CIB                                            00064
CIBVERB  DS    C                                                        00065
*                                                                       00066
CIBSTART EQU   X'04'                                                    00067
CIBMODFY EQU   X'44'                                                    00068
CIBSTOP  EQU   X'40'                                                    00069
CIBMOUNT EQU   X'0C'                                                    00070
*                                                                       00071
CIBLEN   DS    FL1                                                      00072
         DS    XL4  RESERVED                                            00073
CIBASID  DS    0H  ADDRESS SPACE ID..VS2                                00074
CIBTJID  DS    CL2  TSO JID                                             00075
CIBCONID DS    C  CONSOLE ID ISSUING COMM                               00076
         DS    X  RESERVED                                              00077
CIBDATLN DS    H                                                        00078
CIBDATA  DS    CL8                                                      00079
         MEND                                                           00080
         TITLE  '... DIRECT ACCESS VOLUME LIST ...'                     00081
DISKSEEK START 0                                                        00082
         SPACE 1                                                        00083
*                                                                       00084
*FUNCTION -DIRECT ACCESS VOLUME LISTING UTILITY.                        00085
*          IT WILL PRODUCE A LISTING OF EVERY DATASET ON A VOLUME       00086
*          PLUS CALCULATE THE FREE SPACE, FREE DSCBS ETC. OPTIONALLY    00087
*          VIA PARM INFORMATION IT WILL PRODUCE THE FOLLOWING:          00088
*         PARM=MAP - PRODUCE TRACK MAP OF VOLUME.                       00089
*         PARM=SMAP - PRODUCE TRACK MAP OF VOLUME INCLUDING SEEK INFO   00090
*         PARM=PDS - LIST ALL PDS DIRECTORIES ON VOLUME.                00091
*         PARM=ISAM - LIST ISAM REORG ONFORMATION FOR DATASETS.         00092
*         PARM=EXT- LIST THE EXTENTS OF THE DATASETS.                   00093
*         PARM=DUMP - LIST IN HEX ALL DSCBS ON VOLUME.                  00094
*         PARM=EMPTY - LIST ONLY DATASETS THAT ARE EMPTY.               00095
*         PARM=MODEL - WILL ONLY LIST MODEL DSCBS.                      00096
*         PARM=SDUMP - LIST IN HEX FORMAT 4 AND 5 DSCBS.                00097
*         PARM=VOLS - ONLY USE DDNAMES OF VOLUMEXX    .                 00098
*         PARM=JDATE - LIST CREATION/EXPIRATION DATES IN JULIAN.        00099
******     OTHER COMMENT ARE DOCUMENTED IN BEGINING OF SOURCE.          00100
******     NOTE - SYS1.AMODGEN MUST BE CONCATENATED TO MACLIB FOR ASMB  00101
*                                                                       00102
*                                                                       00103
*                                                                       00104
*         STEPNAME SETS NO. OF SAMPLES FOR "SMAP"                       00105
*                                                                       00106
*         STEPNAME FORMAT IS AS FOLLOWS -                               00107
*                                                                       00108
*         SNNNN -                                                       00109
*                  "NNNN"  IS THE NO. OF 1/5 SEC SAMPLES.               00110
*                  IF "NNNN" IS NOT NUMERIC A DEFAULT OF                00111
*                  3000 SAMPLES WILL BE USED (10 MINUTES)               00112
*                                                                       00113
*                                                                       00114
R0       EQU   0                   WORK                                 00115
R1       EQU   1                   WORK                                 00116
R2       EQU   2                   WORK                                 00117
R3       EQU   3                   WORK                                 00118
R4       EQU   4                   WORK                                 00119
R5       EQU   5                   WORK                                 00120
R6       EQU   6                   -> FM1, FM4 DSCB, PDS ENTRY          00121
R7       EQU   7                   -> FM2 DSCB, IF ANY                  00122
R8       EQU   8                   -> FM3, FM5 DSCB, IF ANY             00123
R9       EQU   9                   BASE REG 1                           00124
R10      EQU   10                  BASE REG 2                           00125
R11      EQU   11                  BASE REG 3                           00126
R12      EQU   12                  BASE REG 4                           00127
R13      EQU   13                  -> SAVE AREA                         00128
R14      EQU   14                  LINK, WORK                           00129
R15      EQU   15                  WORK                                 00130
         SPACE 1                                                        00131
SPACE0AP EQU   X'01'                                                    00132
SPACE1AP EQU   X'09'                                                    00133
SPACE2AP EQU   X'11'                                                    00134
SPACE3AP EQU   X'19'                                                    00135
EJECTAP  EQU   X'89'                                                    00136
SPACE0IM EQU   X'03'                                                    00137
SPACE1IM EQU   X'0B'                                                    00138
SPACE2IM EQU   X'13'                                                    00139
SPACE3IM EQU   X'1B'                                                    00140
EJECTIM  EQU   X'8B'                                                    00141
         SPACE 1                                                        00142
DEBUCBAD EQU   32                                                       00143
CAMLSTLN EQU   148                                                      00144
PDSBLKLN EQU   264                                                      00145
NCPDFLT  EQU   10                                                       00146
UTILPRIV EQU   5                                                        00147
OPERPRIV EQU   9                                                        00148
         SPACE 1                                                        00149
EMPTYOPT EQU   X'80'                                                    00150
LSTDTOPT EQU   X'40'                                                    00151
DUMPOPT  EQU   X'20'                                                    00152
SDUMPOPT EQU   X'10'                                                    00153
MAPOPT   EQU   X'08'                                                    00154
PDSOPT   EQU   X'04'                                                    00155
EXTNTOPT EQU   X'02'                                                    00156
DIRFLAG  EQU   X'01'                                                    00157
         SPACE 1                                                        00158
VOLSOPT  EQU   X'80'                                                    00159
LNCNTOPT EQU   X'40'                                                    00160
SMAPOPT  EQU   X'20'                                                    00161
RESETOPT EQU   X'10'                                                    00162
NCPOPT   EQU   X'08'                                                    00163
ISAMOPT  EQU   X'04'                                                    00164
JDATEOPT EQU   X'02'                                                    00165
MODELOPT EQU   X'01'                                                    00166
         EJECT                                                          00167
         SPACE 5                                                        00168
         SAVE  (14,12),,*                                               00169
         LR    R9,R15                                                   00170
         USING DISKSEEK,R9                                              00171
         LM    R10,R12,BASEVALS                                         00172
         USING DISKSEEK,R9,R10,R11,R12                                  00173
         SPACE 1                                                        00174
         LR    R2,R13                                                   00175
         LA    R13,SAVEAREA                                             00176
         ST    R2,SAVEAREA+4                                            00177
         ST    R13,8(,R2)                                               00178
         SR    R2,R2                                                    00179
         SPM   R2                                                       00180
         MVI   SYSTEMSW,X'00'              INITIALIZE MODE SW LMB-CBT   00181
         B     INIT                                                     00182
         SPACE 1                                                        00183
BASEVALS DC    A(DISKSEEK+X'1000',DISKSEEK+X'2000',DISKSEEK+X'3000')    00184
         EJECT                                                          00185
MAXCYL   EQU   2656                                                     00186
MAXTRK   EQU   32                                                       00187
DEVBUSY  STM   R2,R12,VOLSAVE                                           00188
         MVC   VOLTRKS(2),TRKSPCYL                                      00189
         OPEN  (SYSSEEK,(OUTPUT))                                       00190
         L     R1,VOLTAB                                                00191
         LTR   R1,R1               FREEMAIN NECESSARY                   00192
         BZ    DEVBUSY0            NO                                   00193
         L     R0,=A(MAXCYL*MAXTRK*4) VOLTAB LENGTH                     00194
         FREEMAIN R,LV=(0),A=(1)                                        00195
         SPACE 1                                                        00196
DEVBUSY0 L     R0,=A(MAXCYL*MAXTRK*4) VOLTAB LENGTH                     00197
         GETMAIN R,LV=(0)                                               00198
         ST    R1,VOLTAB           VOLTAB ADDR                          00199
         L     R4,VOLUCB           UCB ADDR                             00200
         L     R3,VOLSAMP          NO. OF SAMPLES                       00201
         L     R14,16              CVT                                  00202
         TM    116(R14),X'80'      IS IT X-A?          LMB-CBT          00203
         BC    8,SP3               NO IT IS MVS/SP     LMB-CBT          00204
         MVI   SYSTEMSW,X'01'      SAY IN X-A          LMB-CBT          00205
SP3      L     R14,0(0,R14)        TCB WORDS                            00206
         L     R14,4(0,R14)        CURRENT TCB                          00207
         L     R14,12(0,R14)       TIOT                                 00208
         MVC   SEEKDBL(4),=4C'0'                                        00209
         MVZ   SEEKDBL(4),9(R14)   SNNNN STEP NAME                      00210
         CLC   SEEKDBL(4),=4C'0'   NUMERIC                              00211
         BNE   DEVBUSY1            NO, USE DEFAULT                      00212
         PACK  SEEKDBL(8),9(4,R14)                                      00213
         CVB   R3,SEEKDBL          SPECIFIED NO. OF SAMPLES             00214
         ST    R3,VOLSAMP                                               00215
         SPACE 1                                                        00216
DEVBUSY1 STIMER WAIT,DINTVL=INTERVL                                     00217
         TM    3(R4),X'88'         ONLINE/ALLOCATED                     00218
         BNO   DEVBUSY2            NO                                   00219
         TM    6(R4),X'8A'         BUSY AND/OR CHANNEL PROGRAM ACTIVE   00220
         BZ    DEVBUSY2            NO, NEXT UCB                         00221
         LR    R14,R4             UCB ADDR                              00222
         S     R14,=F'4'          DECR ADDR -4                          00223
         L     R14,0(0,R14)       IOQ ADDR                              00224
         LA    R14,0(0,R14)                                             00225
         LTR   R14,R14            ANY IOQ                               00226
         BZ    DEVBUSY2           NO                                    00227
         L     R14,8(0,R14)       IOSB ADDR                             00228
         TM    SYSTEMSW,X'01'     IS IT AN X-A SYSTEM?     LMB-CBT      00229
         BC    8,LOADIOSB         NO, STAY IN 24 BIT MODE  LMB-CBT      00230
*SWITCH TO 31 BIT MODE ONLY FOR IOSB PROCESSING UNDER XA       LMB-CBT  00231
         L     R1,LABEL1                                                00232
         BSM   0,R1              SET AMODE=31                           00233
LABEL1   DC    A(LABEL2+X'80000000')                                    00234
LABEL2   DS    0H                                                       00235
LOADIOSB LA    R14,0(0,R14)                                             00236
         LTR   R14,R14            EXIST                                 00237
         BZ    DEVBUSY2           NO                                    00238
         SR    R1,R1                                                    00239
         ICM   R1,3,105(R14)      SEEK TRK                              00240
         ST    R1,DOUBTRK                                               00241
         CH    R1,VOLTRKS         CHECK MAX TRK NO. THIS DEVICE         00242
         BL    *+8                OK                                    00243
         LA    R1,31              LAST ENTRY                            00244
         SLL   R1,2                                                     00245
         SR    R15,R15                                                  00246
         ICM   R15,3,103(R14)     SEEK CYL                              00247
         TM    SYSTEMSW,X'01'     IS IT AN X-A SYSTEM?       LMB-FBT    00248
         BC    8,GOPROCES         NO, STAY IN 24 BIT MODE    LMB-CBT    00249
* GO BACK TO 24 BIT MODE. 31 BIT MODE NO LONGER NEEDED       LMB-CBT    00250
         LA    R14,LABEL3      SET HIGH-ORDER BIT (0) OF R14 TO 0       00251
         BSM   0,R14                                                    00252
LABEL3   DS    0H                                                       00253
GOPROCES XR    R14,R14                                                  00254
         ST    R15,DOUBCYL                                              00255
         SLL   R15,7                                                    00256
         AR    R1,R15             VOLTAB ENTRY OFFSET                   00257
         L     R15,VOLTAB                                               00258
         AR    R15,R1             VOLTAB ENTRY ADDR                     00259
         L     R1,0(0,R15)                                              00260
         A     R1,=F'1'                                                 00261
         ST    R1,0(0,R15)                                              00262
         L     R1,VOLSEEK                                               00263
         A     R1,=F'1'                                                 00264
         ST    R1,VOLSEEK                                               00265
         MVC   SEEKPRT+1(120),=CL120'CYL NNNN   TRK NN'                 00266
         UNPK  SEEKPRT+5(5),DOUBCYL+2(3)                                00267
         MVI   SEEKPRT+9,C' '                                           00268
         NC    SEEKPRT+5(4),=4X'0F'                                     00269
         TR    SEEKPRT+5(4),=C'0123456789ABCDEF'                        00270
         UNPK  SEEKPRT+16(3),DOUBTRK+3(2)                               00271
         MVI   SEEKPRT+18,C' '                                          00272
         NC    SEEKPRT+16(2),=4X'0F'                                    00273
         TR    SEEKPRT+16(2),=C'0123456789ABCDEF'                       00274
         PUT   SYSSEEK,SEEKPRT                                          00275
         SPACE 1                                                        00276
DEVBUSY2 BCT   R3,DEVBUSY1                                              00277
         LM    R2,R12,VOLSAVE                                           00278
         CLOSE (SYSSEEK)                                                00279
         BR    R8                                                       00280
         EJECT                                                          00281
         SPACE 3                                                        00282
NEXTVOL  BAL   R14,FREECORE                                             00283
         XC    START0(LENGTH0),START0 WHOLESALE ZEROING OF CORE         00284
         SR    R0,R0                                                    00285
         ST    R0,BUFPTR                                                00286
         MVC   CURLINES,=H'999'                                         00287
         MVI   HEADER,C' '                                              00288
         MVC   HEADER+1(L'HEADER-1),HEADER                              00289
         LA    R1,LASTDS1                                               00290
         ST    R1,FIRSTDS1                                              00291
         LA    R1,HOOKSTRT                                              00292
         ST    R1,HOOKSTRT                                              00293
         MVC   HWMDS1,EFFS                                              00294
         NI    PARMOPT1,255-DIRFLAG                                     00295
         SPACE 1                                                        00296
NEXTDD   TM    PARMOPT2,VOLSOPT                                         00297
         BO    NEXTDDCV                                                 00298
         L     R1,DDLSTPTR                                              00299
         LTR   R1,R1                                                    00300
         BZ    TIOTADV                                                  00301
         LH    R0,DDNAMLEN                                              00302
         SH    R0,=H'8'                                                 00303
         BM    RETURN                                                   00304
         STH   R0,DDNAMLEN                                              00305
         MVC   VOLDDNAM,0(R1)                                           00306
         LA    R1,8(R1)                                                 00307
         ST    R1,DDLSTPTR                                              00308
         B     NMAPSTRT                                                 00309
         SPACE 1                                                        00310
TIOTADV  L     R1,TIOTADDD                                              00311
         USING TIOENTRY,R1                                              00312
         SR    R0,R0                                                    00313
         IC    R0,TIOELNGH                                              00314
         LTR   R0,R0                                                    00315
         BZ    RETURN                                                   00316
         MVC   VOLDDNAM,TIOEDDNM                                        00317
         AR    R1,R0                                                    00318
         ST    R1,TIOTADDD                                              00319
         DROP  R1                                                       00320
         SPACE 1                                                        00321
NMAPSTRT LA    R0,8                                                     00322
         LA    R1,NOMAPDDS                                              00323
         CLC   VOLDDNAM(4),=C'SYS0'   CHECK FOR DAIR DDNAME  R.T.       00324
*        **** THIS IS CAUSED BY DAIR FOR THE CVOL CATALOG ***P.A.S.     00325
         BE    NEXTDD      IF FOUND, DO NOT MAP THIS VOL                00326
NMAPSRCH CLC   VOLDDNAM,0(R1)                                           00327
         BE    NOMAPFND                                                 00328
         BXH   R1,R0,NMAPSRCH                                           00329
         SPACE 1                                                        00330
NOMAPFND LA    R0,VOLDDNAM                                              00331
         CR    R0,R1                                                    00332
         BNE   NEXTDD                                                   00333
         B     TYPEDEV                                                  00334
         SPACE 1                                                        00335
NEXTDDCV LH    R0,CURVOL                                                00336
         CH    R0,NUMVOLS                                               00337
         BNL   RETURN                                                   00338
         AH    R0,=H'1'                                                 00339
         STH   R0,CURVOL                                                00340
         BAL   R14,CONVERT                                              00341
         MVC   CURVOLNM,CONVUNPK+10                                     00342
         SPACE 1                                                        00343
TYPEDEV  DEVTYPE VOLDDNAM,DEVTYPE,DEVTAB,RPS                            00344
         BXH   R15,R15,ERRNODD                                          00345
         CLI   DEVTYPE+2,UCB3DACC                                       00346
         BNE   ERRNOTDA                                                 00347
         SPACE 1                                                        00348
         MVC   DEVTABND,DEVTYPE+3                                       00349
         LA    R0,DEVENTLN                                              00350
         LA    R1,DEVTABLE                                              00351
DEVLOOP  CLC   DEVTABND(1),0(R1)                                        00352
         BE    DEVNTFND                                                 00353
         BXH   R1,R0,DEVLOOP                                            00354
         SPACE 1                                                        00355
DEVNTFND CLC   1(7,R1),DEVTABND+1                                       00356
         BE    ERRUNKDV                                                 00357
         ST    R1,DEVTABPT                                              00358
         SPACE 1                                                        00359
***** THIS SECTION WILL TELL THE DIFFERENCE BETWEEN THE 2 3340 MODELS.  00360
***** THE 3340 HAS 1 UCBTYPE FOR BOTH 35M/70M.                          00361
***** THIS SECTION WILL LOOK FOR THE X'015D' NUMBER OF CYLS....35M      00362
*****   ELSE THE NUMBER OF CYLS (70M) WILL BE X'02BA'...                00363
         SPACE 1                                                        00364
         CLI   DEVTYPE+3,X'0A'   TEST FOR A 3340-?                      00365
         BNE   RVDISK    IF NOT 3340...BYPASS                           00366
         CLC   DEVTYPE+8(2),=X'015D'    TEST FOR A 35M 3340 TYPE        00367
         BE    RVDISK   IF IT IS A 35MEG...NO NEED TO CHANGE DESC       00368
         MVC   6(2,R1),=C'70'   MOVE A "70M" ON DESC OF UNIT            00369
         SPACE 1                                                        00370
*** THIS SECTION WILL DETERMINE IF THE DISK IS REAL, OR MASS STORAGE    00371
         SPACE 1                                                        00372
RVDISK   TM    DEVTYPE+2,X'08'   TEST IF REAL/VIRT DASD                 00373
         BZ    DEVCON   BIT=0, REAL     BIT=1, VIRTUAL                  00374
         MVC   6(9,R1),=C'VIRT VOL.' MOVE "VIRT" DESC OF UNIT           00375
         SPACE 1                                                        00376
******** THIS SECTION WILL LOAD THE CONSTANTS FROM THE "DEVTYPE" TO     00377
********   BE USED BY THE HOMEMADE CCHHR CONVERT ROUTINES.....          00378
*                                                                       00379
DEVCON   MVC   DEVCONV2(2),DEVTYPE+10    LOW ORDER  CC                  00380
         MVC   DEVCONV1(1),DEVTYPE+11     HIGH ORDER CC                 00381
         MVI   DEVCONV1+1,X'00'      FINISH HIGH ORDER CC               00382
         MVC   DEVCONV3(2),=X'0000'   ZERO HIGH ORDER HH                00383
         MVC   DEVCONV4(2),=X'0001'   LOW ORDER  HH                     00384
         MVC   TRKSPCYL(2),DEVTYPE+10    TRKS/CYL                       00385
         SR    R1,R1                                                    00386
         LH    R1,DEVTYPE+8    LOAD  CYL PER VOLUME                     00387
         MH    R1,DEVTYPE+10   MULT "CYL/VOL" BY "TRKS/CYL"             00388
         STH   R1,TRKSPVOL    RESULT IS  "TRACKS/VOLUME"                00389
*                                                                       00390
         MVC   DCBDDNAM+(PDSDCB-IHADCB),VOLDDNAM                        00391
         MVC   DCBDDNAM+(VTOCDCB-IHADCB),VOLDDNAM                       00392
         SPACE 1                                                        00393
         RDJFCB MF=(E,OPENLIST)                                         00394
         TM    JFCBTSDM,X'20'                                           00395
         BO    ERRNOTDA                                                 00396
         MVI   JFCBDSNM,X'04'                                           00397
         MVC   JFCBDSNM+1(43),JFCBDSNM                                  00398
         OI    JFCBTSDM,X'08'                                           00399
         SPACE 1                                                        00400
         LH    R1,NCPPARM                                               00401
         SR    R0,R0                                                    00402
         IC    R0,JFCNCP                                                00403
         MVI   JFCNCP,0                                                 00404
         LTR   R0,R0                                                    00405
         BZ    SAVENCP                                                  00406
         LR    R1,R0                                                    00407
SAVENCP  ST    R1,RENCP                                                 00408
         OI    DCBOPTCD+(VTOCDCB-IHADCB),DCBOPTC                        00409
         CH    R1,=H'1'                                                 00410
         BNE   SETNCP                                                   00411
         SR    R1,R1                                                    00412
         NI    DCBOPTCD+(VTOCDCB-IHADCB),255-DCBOPTC                    00413
SETNCP   STC   R1,DCBNCP+(VTOCDCB-IHADCB)                               00414
         SPACE 1                                                        00415
         OPEN  TYPE=J,MF=(E,OPENLIST)                                   00416
         TM    DCBOFLGS+(VTOCDCB-IHADCB),DCBOFOPN                       00417
         BZ    ERRNOPEN                                                 00418
         L     R2,DCBDEBAD+(VTOCDCB-IHADCB)                             00419
         L     R2,DEBUCBAD(,R2)                                         00420
         SPACE 1                                                        00421
********  THIS SECTION DELETED    4/1/75    P.A.S.                      00422
********  IT WAS USED FOR DATA CELLS...NO LONGER SUPPORTED              00423
         SPACE 1                                                        00424
         USING UCBOB,R2                                                 00425
MAINUCB  MVC   VTOCTTR,UCBVTOC                                          00426
         MVC   VOLSERNO,UCBVOLI                                         00427
         MVC   VOLSTAT,UCBSTAT                                          00428
         MVC   HEAD1UCB,UCBNAME     MOVE EBCIDIC UCB ADDR FOR HEADN     00429
         TM    UCBSTAB,UCBBPUB    TEST FOR PUBLIC MOUNT                 00430
         BNO   *+10                                                     00431
         MVC   HEAD1MT,=C'PUBLIC  '                                     00432
         TM    UCBSTAB,UCBBPRV    TEST FOR PRIVATE                      00433
         BNO   *+10                                                     00434
         MVC   HEAD1MT,=C'PRIVATE '                                     00435
         TM    UCBSTAB,UCBBSTR   TEST FOR STORAGE                       00436
         BNO   *+10                                                     00437
         MVC   HEAD1MT,=C'STORAGE '                                     00438
         TM    UCBSTAB,UCBPGFL    TEST IF PAGING DEVIC                  00439
         BNO   *+10                                                     00440
         MVC   HEAD1MT,=C'*PAGING*'                                     00441
         TM    UCBSTAT,UCBSYSR    TEST FOR SYS-RES                      00442
         BNO   *+10                                                     00443
         MVC   HEAD1MT,=C'*SYSRES*'                                     00444
         SPACE 1                                                        00445
         MVC   HEAD1MTR,=C'REMOV'                                       00446
         TM    UCBSTAT,UCBRESV                                          00447
         BNO   *+10                                                     00448
         MVC   HEAD1MTR,=C'RSERV'                                       00449
         TM    UCBSTAT,UCBPRES                                          00450
         BNO   *+10                                                     00451
         MVC   HEAD1MTR,=C'RSDNT'                                       00452
         SPACE 1                                                        00453
COMONUCB ST    R2,UCBADDR                                               00454
         ST    R2,VOLUCB                                                00455
         DROP  R2                                                       00456
         MVC   HEAD1VOL,VOLSERNO                                        00457
         MVC   HEADMID(81),HEAD1                                        00458
         TM    PARMOPT2,SMAPOPT                                         00459
         BZ    *+8                                                      00460
         BAL   R8,DEVBUSY            BUILD VOL TAB                      00461
         SPACE 1                                                        00462
         ENQ   MF=(E,ENQVTOC)                                           00463
         NI    DEQGATE,X'0F'                                            00464
         SPACE 1                                                        00465
         LH    R1,VTOCTT                                                00466
         BAL   R14,TTCONVRT                                             00467
         MVC   VTOCCCHH,CCHH                                            00468
         MVI   VTDSCBTR+1,255                                           00469
         SPACE 1                                                        00470
         SR    R4,R4                                                    00471
         IC    R4,DCBKEYLE+(VTOCDCB-IHADCB)                             00472
         AH    R4,DCBBLKSI+(VTOCDCB-IHADCB)                             00473
         AH    R4,=H'20'                                                00474
         ST    R4,REBLKSIZ                                              00475
         L     R5,RENCP                                                 00476
         ST    R5,RECOUNT                                               00477
         LR    R1,R4                                                    00478
         MR    R0,R5                                                    00479
         LR    R0,R1                                                    00480
         ST    R0,REGETSIZ                                              00481
         GETMAIN EC,LV=(0),A=REBLOCK@                                   00482
         BXH   R15,R15,ERRNOCOR                                         00483
         L     R2,REBLOCK@                                              00484
         ST    R2,RENEXT@                                               00485
         LA    R3,VTOCDCB                                               00486
         SPACE 1                                                        00487
READINIT XC    0(20,R2),0(R2)                                           00488
         LA    R4,20(R2)                                                00489
         READ  (2),SF,(3),(4),MF=E                                      00490
         A     R2,REBLKSIZ                                              00491
         BCT   R5,READINIT                                              00492
         SPACE 1                                                        00493
         LA    R4,DS4LEN                                                00494
         BAL   R14,GETCORE                                              00495
         ST    R3,FMT4AD                                                00496
         LR    R6,R3                                                    00497
         USING DS4,R6                                                   00498
         BAL   R14,VTOCREAD                                             00499
         BAL   R14,ABDUMP                                               00500
         CLI   DS4IDFMT,C'4'                                            00501
         MVI   BADDSTYP,C'4'                                            00502
         LR    R8,R6                                                    00503
         BNE   ERRNOTFX                                                 00504
         MVI   FM4COUNT+1,1                                             00505
         TM    DS4VTOCI,X'04'                                           00506
         BZ    *+8                                                      00507
         OI    PARMOPT1,DIRFLAG                                         00508
         MVC   HOOKLCCH(20),HOOKINIT                                    00509
         LA    R2,HOOKPTR                                               00510
         BAL   R14,HOOKUP                                               00511
         SR    R0,R0                                                    00512
         IC    R0,DS4DEVDT                                              00513
         STH   R0,VTDSCBTR                                              00514
         TM    PARMOPT2,RESETOPT                                        00515
         BNZ   *+10                                                     00516
         MVC   HWMDS1,DS4HPCHR                                          00517
         MVC   HOOKLCCH(8),DS4VTOCE+2                                   00518
         LA    R2,DS4VTOCE                                              00519
         BAL   R14,F1EXTCNV                                             00520
         STH   R0,HOOKNTRK                                              00521
         STH   R0,VTOCSIZE                                              00522
         MVC   HOOKLOTT(4),LOWTT                                        00523
         MVI   HOOKTYPE,C'4'                                            00524
         MVC   HOOKSEQN,DS4VTOCE+1                                      00525
         MVC   HOOKIDPT,=A(VTOCMSG)                                     00526
         LA    R2,HOOKPTR                                               00527
         BAL   R14,HOOKUP                                               00528
         SPACE 1                                                        00529
         LA    R4,DS5LEN                                                00530
         BAL   R14,GETCORE                                              00531
         ST    R3,FMT5AD                                                00532
         LR    R8,R3                                                    00533
         USING DS5,R8                                                   00534
         BAL   R14,VTOCREAD                                             00535
         BAL   R14,ABDUMP                                               00536
         CLI   DS5FMTID,C'5'                                            00537
         MVI   BADDSTYP,C'5'                                            00538
         BNE   ERRNOTFX                                                 00539
         MVI   FM5COUNT+1,1                                             00540
         BAL   R14,F56HOOK                                              00541
         SR    R0,R0                                                    00542
         ST    R0,DS5F5PTR                                              00543
         DROP  R6,R8                                                    00544
         EJECT                                                          00545
         SPACE 3                                                        00546
NEXTFM1  LA    R4,DS1LEN                                                00547
         BAL   R14,GETCORE                                              00548
         LR    R6,R3                                                    00549
         USING DS1,R6                                                   00550
READFM1  BAL   R14,VTOCREAD                                             00551
         B     READFM5                                                  00552
         SR    R1,R1                                                    00553
         IC    R1,DS1FMTID                                              00554
         N     R1,=F'15'                                                00555
         CH    R1,=H'6'                                                 00556
         BNH   *+8                                                      00557
         BAL   R14,ABDUMP                                               00558
         SLL   R1,1                *2                                   00559
         LH    R2,FMXCOUNT(R1)                                          00560
         LA    R2,1(R2)                                                 00561
         STH   R2,FMXCOUNT(R1)                                          00562
         LTR   R1,R1                                                    00563
         BNZ   CHECKDS1                                                 00564
         CLI   HWMINDIC,1                                               00565
         BE    READFM1                                                  00566
         MVC   HWMNEW,DS1FDAD+3                                         00567
         MVI   HWMINDIC,1                                               00568
         B     READFM1                                                  00569
         SPACE 1                                                        00570
CHECKDS1 CLI   DS1FMTID,C'1'                                            00571
         BNE   READFM1                                                  00572
         MVC   HWMNEW,DS1FDAD+3                                         00573
         MVI   HWMINDIC,1                                               00574
         L     R2,FIRSTDS1                                              00575
         L     R3,=A(FIRSTDS1-(DS1F1PTR-DS1))                           00576
COMPFM1  CLC   DS1DSNAM,DS1DSNAM-DS1(R2)                                00577
         BL    INSRTFM1                                                 00578
         LR    R3,R2                                                    00579
         L     R2,DS1F1PTR-DS1(R2)                                      00580
         B     COMPFM1                                                  00581
INSRTFM1 ST    R2,DS1F1PTR                                              00582
         ST    R6,DS1F1PTR-DS1(R3)                                      00583
         SR    R0,R0                                                    00584
         ST    R0,DS1F3PTR                                              00585
         B     NEXTFM1                                                  00586
         SPACE 1                                                        00587
         DROP  R6                                                       00588
         EJECT                                                          00589
         SPACE 3                                                        00590
READFM5  BAL   R14,CLOSVTOC                                             00591
         L     R6,FMT4AD                                                00592
         USING DS4,R6                                                   00593
         L     R8,FMT5AD                                                00594
         USING DS5,R8                                                   00595
         B     CHECKFM5                                                 00596
         SPACE 1                                                        00597
NEXTFM5  LA    R4,DS5LEN                                                00598
         BAL   R14,GETCORE                                              00599
         ST    R3,DS5F5PTR                                              00600
         LA    R2,DS5PTRDS                                              00601
         LR    R8,R3                                                    00602
         BAL   R14,OBTAIN                                               00603
         CLI   DS5FMTID,C'5'                                            00604
         MVI   BADDSTYP,C'5'                                            00605
         BNE   ERRNOTFX                                                 00606
         BAL   R14,F56HOOK                                              00607
         SR    R0,R0                                                    00608
         ST    R0,DS5F5PTR                                              00609
CHECKFM5 CLC   DS5PTRDS,ZEROES                                          00610
         BNE   NEXTFM5                                                  00611
         SPACE 1                                                        00612
         CLC   DS4F6PTR,ZEROES                                          00613
         BE    READFM23                                                 00614
         LA    R4,DS6LEN                                                00615
         BAL   R14,GETCORE                                              00616
         ST    R3,FMT6AD                                                00617
         LA    R2,DS4F6PTR                                              00618
         SPACE 1                                                        00619
READFM6  LR    R8,R3                                                    00620
         USING DS6,R8                                                   00621
         BAL   R14,OBTAIN                                               00622
         CLI   DS6FMTID,C'6'                                            00623
         MVI   BADDSTYP,C'6'                                            00624
         BNE   ERRNOTFX                                                 00625
         BAL   R14,F56HOOK                                              00626
         SR    R3,R3                                                    00627
         ST    R3,DS6F6PTR                                              00628
         CLC   DS6PTRDS,ZEROES                                          00629
         BE    READFM23                                                 00630
         LA    R4,DS6LEN                                                00631
         BAL   R14,GETCORE                                              00632
         ST    R3,DS6F6PTR                                              00633
         LA    R2,DS6PTRDS                                              00634
         B     READFM6                                                  00635
         SPACE 1                                                        00636
         DROP  R6,R8                                                    00637
         EJECT ,                                                        00638
         SPACE 3                                                        00639
READFM23 L     R6,=A(FIRSTDS1-(DS1F1PTR-DS1))                           00640
         USING DS1,R6                                                   00641
NEXTFM23 L     R6,DS1F1PTR                                              00642
         CLC   DS1DSNAM,LASTDS1                                         00643
         BE    VTOCUPDT                                                 00644
         CLC   DS1PTRDS,ZEROES                                          00645
         BE    NEXTFM23                                                 00646
         SPACE 2                                                        00647
         LA    R4,DS3LEN                                                00648
         BAL   R14,GETCORE                                              00649
         LR    R8,R3                                                    00650
         USING DS3,R8                                                   00651
         LA    R2,DS1PTRDS                                              00652
         BAL   R14,OBTAIN                                               00653
         ST    R8,DS1F3PTR                                              00654
         SR    R0,R0                                                    00655
         ST    R0,DS3F2PTR                                              00656
         TM    DS1DSORG,DCBDSGIS                                        00657
         BNO   CHECKFM3                                                 00658
         USING DS2,R8                                                   00659
         CLI   DS2FMTID,C'2'                                            00660
         BNE   CHECKFM3                                                 00661
         CLC   DS2PTRDS,ZEROES                                          00662
         BE    NEXTFM23                                                 00663
         LA    R4,DS3LEN                                                00664
         BAL   R14,GETCORE                                              00665
         ST    R3,DS2F3PTR                                              00666
         LA    R2,DS2PTRDS                                              00667
         BAL   R14,OBTAIN                                               00668
         ST    R8,DS3F2PTR-DS3(,R3)                                     00669
         LR    R8,R3                                                    00670
         USING DS3,R8                                                   00671
         SPACE 1                                                        00672
CHECKFM3 CLI   DS3FMTID,C'3'                                            00673
         BE    NEXTFM23                                                 00674
         MVI   BADDSTYP,C'3'                                            00675
         B     ERRNOTFX                                                 00676
         SPACE 1                                                        00677
         DROP  R6,R8                                                    00678
         EJECT ,                                                        00679
         SPACE 1                                                        00680
VTOCUPDT TM    PARMOPT2,RESETOPT                                        00681
         BZ    VTOCPRT                                                  00682
         TM    PARMOPT1,DIRFLAG                                         00683
         BO    VTOCPRT                                                  00684
         OI    OPENFLAG,OPENUPDT                                        00685
         OPEN  TYPE=J,MF=(E,OPENLIST)                                   00686
         TM    DCBOFLGS+(VTOCDCB-IHADCB),DCBOFOPN                       00687
         BO    *+8                                                      00688
         BAL   R14,ABEND                                                00689
         NI    OPENFLAG,255-OPENUPDT                                    00690
         SPACE 1                                                        00691
VTOCUPRD READ  VTOCDECB,SF,MF=E                                         00692
         CHECK VTOCDECB                                                 00693
         LA    R1,=CL11'VTOC READ.'                                     00694
         BAL   R14,SYNADCHK                                             00695
         MVC   DS4FDAD+(CAMLIST-DS4),DCBFDAD+(VTOCDCB-IHADCB)           00696
         SPACE 1                                                        00697
         CLI   DS4IDFMT+(CAMLIST-DS4),C'4'                              00698
         MVI   BADDSTYP,C'4'                                            00699
         LA    R8,CAMLIST                                               00700
         BNE   ERRNOTFX                                                 00701
         MVC   HWMOLD,DS4HPCHR+(CAMLIST-DS4)                            00702
         MVC   DS4HPCHR+(CAMLIST-DS4),HWMNEW                            00703
         SPACE 1                                                        00704
         WRITE VTOCDECB,SF,MF=E                                         00705
         CHECK VTOCDECB                                                 00706
         LA    R1,=CL11'VTOC WRITE.'                                    00707
         BAL   R14,SYNADCHK                                             00708
         L     R1,FMT4AD                                                00709
         MVC   0(DS4LEN,R1),CAMLIST                                     00710
         SPACE 1                                                        00711
VTOCUPCL CLOSE (VTOCDCB)                                                00712
         BAL   R14,DEQVTOC                                              00713
         SPACE 1                                                        00714
         MVC   BUF+1(31),=C'VTOC RESET INFO:  OLD FMT1 HWM='            00715
         MVI   BUF+36,C'.'                                              00716
         MVI   BUF+41,C'.'                                              00717
         UNPK  TRAREA,HWMOLD(8)                                         00718
         TR    TRAREA,TRTABLE                                           00719
         MVC   BUF+32(4),TRAREA                                         00720
         MVC   BUF+37(4),TRAREA+4                                       00721
         MVC   BUF+42(2),TRAREA+8                                       00722
         SPACE 1                                                        00723
         MVC   BUF+47(13),=C'NEW FMT1 HWM='                             00724
         MVI   BUF+64,C'.'                                              00725
         MVI   BUF+69,C'.'                                              00726
         UNPK  TRAREA,HWMNEW(8)                                         00727
         TR    TRAREA,TRTABLE                                           00728
         MVC   BUF+60(4),TRAREA                                         00729
         MVC   BUF+65(4),TRAREA+4                                       00730
         MVC   BUF+70(2),TRAREA+8                                       00731
         MVI   BUF,SPACE3AP                                             00732
         BAL   R14,PRINT                                                00733
         EJECT                                                          00734
         SPACE 1                                                        00735
VTOCPRT  BAL   R14,DEQVTOC                                              00736
         L     R6,FMT4AD                                                00737
         USING DS4,R6                                                   00738
         SPACE 1                                                        00739
         MVC   BUF+1(19),=C'DEVICE DESCRIPTION:'                        00740
         MVC   BUF+22(5),=C'TYPE='                                      00741
         L     R2,DEVTABPT                                              00742
         MVC   BUF+27(15),1(R2)                                         00743
         SPACE 1                                                        00744
         MVC   BUF+44(7),=C'NOCYLS='                                    00745
         LA    R2,DS4DEVSZ                                              00746
         BAL   R14,CONVERT2                                             00747
         MVC   BUF+51(5),CONVERTD                                       00748
         SPACE 1                                                        00749
         MVC   BUF+58(9),=C'TRKS/CYL='                                  00750
         LA    R2,DS4DEVSZ+2                                            00751
         BAL   R14,CONVERT2                                             00752
         MVC   BUF+67(5),CONVERTD                                       00753
         SPACE 1                                                        00754
         MVC   BUF+74(8),=C'TRKSIZE='                                   00755
         LA    R2,DS4DEVTK                                              00756
         BAL   R14,CONVERT2                                             00757
         MVC   BUF+82(5),CONVERTD                                       00758
         SPACE 1                                                        00759
         MVC   BUF+89(12),=C'MAX BLKSIZE='                              00760
         LA    R2,DEVTYPE+6                                             00761
         BAL   R14,CONVERT2                                             00762
         MVC   BUF+101(5),CONVERTD                                      00763
         SPACE 1                                                        00764
         MVC   BUF+108(9),=C'DSCB/TRK='                                 00765
         LA    R2,DS4DEVDT                                              00766
         BAL   R14,CONVERT1                                             00767
         MVC   BUF+117(3),CONVERTD                                      00768
         SPACE 1                                                        00769
         MVC   BUF+122(8),=C'PDS/TRK='                                  00770
         LA    R2,DS4DEVDB                                              00771
         BAL   R14,CONVERT1                                             00772
         MVC   BUF+130(3),CONVERTD                                      00773
         MVI   BUF,SPACE2AP                                             00774
         BAL   R14,PRINT                                                00775
         SPACE 1                                                        00776
         MVC   BUF+1(11),=C'VTOC DESCR:'                                00777
         MVC   BUF+13(7),=C'R/W=0/0'                                    00778
         CLI   DS4SECLV,0                                               00779
         BE    VTPRDSCB                                                 00780
         UNPK  TRAREA,DS4SECLV(8)                                       00781
         TR    TRAREA,TRTABLE                                           00782
         MVC   BUF+17(1),TRAREA                                         00783
         MVC   BUF+19(1),TRAREA+1                                       00784
         SPACE 1                                                        00785
VTPRDSCB MVC   BUF+23(6),=C'DSCBS='                                     00786
         SR    R0,R0                                                    00787
         IC    R0,DS4DEVDT                                              00788
         MH    R0,VTOCSIZE                                              00789
         BAL   R14,CONVERT                                              00790
         MVC   BUF+29(5),CONVERTD                                       00791
         SPACE 1                                                        00792
         MVC   BUF+35(6),=C'AVAIL='                                     00793
         LA    R2,DS4DSREC                                              00794
         BAL   R14,CONVERT2                                             00795
         MVC   BUF+41(5),CONVERTD                                       00796
         SPACE 1                                                        00797
         MVC   BUF+47(9),=C'VTOC EXT='                                  00798
         MVI   BUF+60,C'.'                                              00799
         MVI   BUF+65,C'-'                                              00800
         MVI   BUF+70,C'.'                                              00801
         UNPK  TRAREA,DS4VTOCE+2(8)                                     00802
         TR    TRAREA,TRTABLE                                           00803
         MVC   BUF+56(4),TRAREA                                         00804
         MVC   BUF+61(4),TRAREA+4                                       00805
         UNPK  TRAREA,DS4VTOCE+6(8)                                     00806
         TR    TRAREA,TRTABLE                                           00807
         MVC   BUF+66(4),TRAREA                                         00808
         MVC   BUF+71(4),TRAREA+4                                       00809
         SPACE 1                                                        00810
         MVC   BUF+78(9),=C'FMT1 HWM='                                  00811
         MVI   BUF+91,C'.'                                              00812
         MVI   BUF+96,C'.'                                              00813
         UNPK  TRAREA,DS4HPCHR(8)                                       00814
         TR    TRAREA,TRTABLE                                           00815
         MVC   BUF+87(4),TRAREA                                         00816
         MVC   BUF+92(4),TRAREA+4                                       00817
         MVC   BUF+97(2),TRAREA+8                                       00818
         SPACE 1                                                        00819
         MVC   BUF+101(7),=C'NUMALT='                                   00820
         LA    R2,DS4NOATK                                              00821
         BAL   R14,CONVERT2                                             00822
         MVC   BUF+108(5),CONVERTD                                      00823
         SPACE 1                                                        00824
       LH   R2,TRKSPVOL    LOAD TRKS PER VOL TOTAL                      00825
       SH   R2,DS4NOATK     SUBTRACT OFF ALTERNATES LEFT                00826
       STH    R2,TRKSPVOL     TOTAL PER VOL = OLD TOT - ALTS            00827
             SPACE   1                                                  00828
         MVC   BUF+114(8),=C'NEXTALT='                                  00829
         UNPK  TRAREA,DS4HCCHH(8)                                       00830
         TR    TRAREA,TRTABLE                                           00831
         MVC   BUF+122(4),TRAREA                                        00832
         MVI   BUF+126,C'.'                                             00833
         MVC   BUF+127(4),TRAREA+4                                      00834
         MVI   BUF,SPACE2AP                                             00835
         BAL   R14,PRINT                                                00836
         SPACE 1                                                        00837
         MVC   BUF+1(16),=C'AVAILABLE SPACE:'                           00838
         LH    R0,AVAILSPC                                              00839
         BAL   R14,CONVERT                                              00840
         MVC   BUF+18(5),CONVEDIT+7                                     00841
         SPACE 1                                                        00842
         MVC   BUF+24(9),=C'TRACKS IN'                                  00843
         LH    R0,AVAILEXT                                              00844
         BAL   R14,CONVERT                                              00845
         MVC   BUF+34(4),CONVEDIT+8                                     00846
         SPACE 1                                                        00847
         MVC   BUF+39(18),=C'EXTENTS, INCLUDING'                        00848
         LH    R0,AVAILCYL                                              00849
         BAL   R14,CONVERT                                              00850
         MVC   BUF+58(4),CONVEDIT+8                                     00851
         SPACE 1                                                        00852
         MVC   BUF+63(34),=C'FULL CYLINDERS.  LARGEST EXTENT IS'        00853
         LA    R2,F5LARGST                                              00854
         BAL   R14,CONVERT2                                             00855
         MVC   BUF+98(5),CONVEDIT+7                                     00856
         SPACE 1                                                        00857
         MVC   BUF+104(14),=C'CYLINDERS PLUS'                           00858
         LA    R2,F5LARGST+2                                            00859
         BAL   R14,CONVERT1                                             00860
         MVC   BUF+119(3),CONVEDIT+9                                    00861
         SPACE 1                                                        00862
         MVC   BUF+123(7),=C'TRACKS.'                                   00863
         MVI   BUF,SPACE2AP                                             00864
         BAL   R14,PRINT                                                00865
         SPACE 1                                                        00866
         TM    DS4VSAM,X'80'     TEST FOR VSAM OWNERSHIP BIT TURNED ON  00867
         BZ    NOVSAM            IF NOT ON....NOT OWNED BY VSAM         00868
         MVC   BUF+2(41),=C'*** THIS PACK IS OWNED BY A VSAM CATALOG '  00869
         MVI   BUF,SPACE2AP                                             00870
         BAL   R14,PRINT                                                00871
         CLC   DS4VTOCE+24(2),ZEROES      CHECK FOR A "CRA" POINTER     00872
         BE    NOVSAM      IF ZERO, NO POINTER....NO "CRA"              00873
         MVC   CRATRACK(2),DS4VTOCE+24  MOVE CRA ADDRESS FOR ALIGNMENT  00874
         MVC   BUF+2(41),=C'*** THIS PACK CONTAINS A C.R.A. AT TRACK:'  00875
         LH    R0,CRATRACK     LOAD UP 2 BYTE CRA ADDRESS               00876
         BAL   R14,CONVERT    GO CONVERT TO EBCIDIC                     00877
         MVC   BUF+43(5),CONVEDIT+7     MOVE TO PRINT LINE              00878
         MVI   BUF,SPACE2AP                                             00879
         BAL   R14,PRINT                                                00880
         SPACE 1                                                        00881
NOVSAM   EQU   *                                                        00882
         TM    PARMOPT1,DIRFLAG                                         00883
         BZ    NODIRFLG                                                 00884
         MVC   BUF+1(59),=C'*** WARNING - POSSIBLE VTOC ERRORS EXIST ONX00885
                THIS VOLUME ***'                                        00886
         MVI   BUF,SPACE2AP                                             00887
         BAL   R14,PRINT                                                00888
         SPACE 3                                                        00889
NODIRFLG TM    PARMOPT1,DUMPOPT+SDUMPOPT+DIRFLAG                        00890
         BZ    FM1PRINT                                                 00891
         SPACE 1                                                        00892
         LR    R2,R6                                                    00893
         LA    R3,DS4FDAD                                               00894
         BAL   R14,DUMPDSCB                                             00895
         SPACE 1                                                        00896
         L     R8,FMT5AD                                                00897
         USING DS5,R8                                                   00898
DMPF5TST LTR   R8,R8                                                    00899
         BZ    ENDUMPF5                                                 00900
         LR    R2,R8                                                    00901
         LA    R3,DS5FDAD                                               00902
         BAL   R14,DUMPDSCB                                             00903
         L     R8,DS5F5PTR                                              00904
         B     DMPF5TST                                                 00905
         SPACE 1                                                        00906
ENDUMPF5 L     R8,FMT6AD                                                00907
         USING DS6,R8                                                   00908
DMPF6TST LTR   R8,R8                                                    00909
         BZ    ENDUMPF6                                                 00910
         LR    R2,R8                                                    00911
         LA    R3,DS6FDAD                                               00912
         BAL   R14,DUMPDSCB                                             00913
         L     R8,DS6F6PTR                                              00914
         B     DMPF6TST                                                 00915
         SPACE 1                                                        00916
ENDUMPF6 MVI   BUF,SPACE2IM                                             00917
         BAL   R14,PRINT                                                00918
         SPACE 1                                                        00919
         DROP  R6,R8                                                    00920
         EJECT                                                          00921
FM1PRINT L     R6,=A(FIRSTDS1-(DS1F1PTR-DS1))                           00922
         USING DS1,R6                                                   00923
         LA    R1,HEAD1A                                                00924
         ST    R1,BUFPTR                                                00925
         PUT   PRINTDCB,HEADER1                                         00926
         PUT   PRINTDCB,HEADER2                                         00927
         LH    R0,CURLINES                                              00928
         AH    R0,=H'2'                                                 00929
         STH   R0,CURLINES                                              00930
         SPACE 2                                                        00931
FM1PRLOP L     R6,DS1F1PTR                                              00932
         CLC   DS1DSNAM,LASTDS1                                         00933
         BE    FM1PREND                                                 00934
         SR    R7,R7                                                    00935
         L     R8,DS1F3PTR                                              00936
         USING DS3,R8                                                   00937
         LTR   R8,R8                                                    00938
         BZ    FM1GOHK                                                  00939
         CLI   DS3FMTID,C'3'                                            00940
         BE    FM1GOHK                                                  00941
         LR    R7,R8                                                    00942
         USING DS2,R7                                                   00943
         L     R8,DS2F3PTR                                              00944
FM1GOHK  BAL   R14,F13HOOK                                              00945
         LA    R2,1                                                     00946
         TM    PARMOPT1,EXTNTOPT                                        00947
         BZ    FM1TSTIS                                                 00948
         LH    R1,NUMEXT                                                00949
         LA    R2,2(R1,R2)                                              00950
FM1TSTIS LTR   R7,R7                                                    00951
         BZ    FM1TSTDP                                                 00952
         TM    PARMOPT2,ISAMOPT                                         00953
         BZ    *+8                                                      00954
         AH    R2,=H'4'                                                 00955
FM1TSTDP TM    PARMOPT1,DUMPOPT                                         00956
         BZ    FM1LKAHD                                                 00957
         AH    R2,=H'4'                                                 00958
         LTR   R7,R7                                                    00959
         BZ    *+8                                                      00960
         AH    R2,=H'4'                                                 00961
         LTR   R8,R8                                                    00962
         BZ    FM1LKAHD                                                 00963
         AH    R2,=H'4'                                                 00964
FM1LKAHD BAL   R14,PRLKAHED                                             00965
         SPACE 1                                                        00966
         MVC   L1DSNAME,DS1DSNAM                                        00967
         SPACE 1                                                        00968
FM1VOLSR MVC   L1SERIAL,DS1DSSN                                         00969
         SPACE 1                                                        00970
FM1SECUR MVC   L1SECUR,=C'-/-'                                          00971
         TM    DS1DSIND,X'10'  TEST FOR PASSWORD FOR R & W              00972
         BZ    FM1CREDT     IF NO BITS....NO PASSWORD                   00973
         MVI   L1SECUR+2,C'W'      AT LEAST "WRITE" IF ANY              00974
         TM    DS1DSIND,X'04'      TEST FOR ONLY "WRITE"..READ OK       00975
         BO    FM1CREDT       IF ON,  "READ" NOT PROTECTED              00976
         MVI   L1SECUR,C'R'      INDICATE "READ" PROTECT                00977
         SPACE 1                                                        00978
FM1CREDT LA    R2,DS1CREDT                                              00979
         LA    R3,L1CREDT                                               00980
         BAL   R14,DATEDIT                                              00981
         SPACE 1                                                        00982
         LA    R2,DS1EXPDT                                              00983
         LA    R3,L1EXPDT                                               00984
         BAL   R14,DATEDIT                                              00985
         SPACE 1                                                        00986
         LA    R2,DS1REFD   IF YOU GET AN ERROR ASSEMBLING THIS AXC     00987
         LA    R3,L1REFDT   IT IS BECAUSE YOU DO NOT HAVE SU60  AXC     00988
         BAL   R14,DATEDIT  JUST NO-OP THESE THREE INSTRUCTIONS AXC     00989
         SPACE 1                                                        00990
FM1DSORG LA    R2,L1DSORG                                               00991
         TM    DS1DSORG,DCBDSGIS                                        00992
         BZ    FM1DSO1                                                  00993
         MVC   0(2,R2),=C'IS'                                           00994
         LA    R2,2(R2)                                                 00995
FM1DSO1  TM    DS1DSORG,DCBDSGPS                                        00996
         BZ    FM1DSO2                                                  00997
         MVC   0(2,R2),=C'PS'                                           00998
         LA    R2,2(R2)                                                 00999
FM1DSO2  TM    DS1DSORG,DCBDSGDA                                        01000
         BZ    FM1DSO3                                                  01001
         MVC   0(2,R2),=C'DA'                                           01002
         LA    R2,2(R2)                                                 01003
FM1DSO3  TM    DS1DSORG,DCBDSGCX                                        01004
         BZ    FM1DSO6              AXC                                 01005
         MVC   0(2,R2),=C'CX'                                           01006
         LA    R2,2(R2)                                                 01007
*FM1DSO4 TM    DS1DSORG,=X'08'      AXC                                 01008
*        BZ    FM1DSO5              AXC                                 01009
*        MVC   0(2,R2),=C'CQ'       AXC                                 01010
*        LA    R2,2(R2)             AXC                                 01011
*FM1DSO5 TM    DS1DSORG,=X'04'      AXC                                 01012
*        BZ    FM1DSO6              AXC                                 01013
*        MVC   0(2,R2),=C'MQ'       AXC                                 01014
*        LA    R2,2(R2)             AXC                                 01015
FM1DSO6  TM    DS1DSORG,DCBDSGPO                                        01016
         BZ    FM1DSO7                                                  01017
         MVC   0(2,R2),=C'PO'                                           01018
         LA    R2,2(R2)                                                 01019
FM1DSO7  TM    DS1DSORG+1,DCBDSGGS                                      01020
         BZ    FM1DSO8                                                  01021
         MVC   0(2,R2),=C'GS'                                           01022
         LA    R2,2(R2)                                                 01023
FM1DSO8  TM    DS1DSORG+1,DCBDSGTX                                      01024
         BZ    FM1DSO9                                                  01025
         MVC   0(2,R2),=C'TX'                                           01026
         LA    R2,2(R2)                                                 01027
FM1DSO9  TM    DS1DSORG+1,DCBDSGTQ                                      01028
         BZ    FM1DSO10                                                 01029
         MVC   0(2,R2),=C'TQ'                                           01030
         LA    R2,2(R2)                                                 01031
FM1DSO10 TM    DS1DSORG+1,DCBACBM                                       01032
         BZ    FM1DSO11                                                 01033
         MVC   0(2,R2),=C'AM'                                           01034
         LA    R2,2(R2)                                                 01035
FM1DSO11 TM    DS1DSORG+1,DCBDSGTR                                      01036
         BZ    FM1DSO12                                                 01037
         MVC   0(2,R2),=C'TR'                                           01038
         LA    R2,2(R2)                                                 01039
FM1DSO12 TM    DS1DSORG,DCBDSGU                                         01040
         BZ    *+8                                                      01041
         MVI   0(R2),C'U'                                               01042
         SPACE 1                                                        01043
         LA    R2,L1RECFM                                               01044
         TM    DS1RECFM,DCBRECU                                         01045
         BZ    FM1RECF1                                                 01046
         MVI   0(R2),C'U'                                               01047
         BO    FM1RECF1                                                 01048
         TM    DS1RECFM,DCBRECF                                         01049
         MVI   0(R2),C'F'                                               01050
         BO    FM1RECF1                                                 01051
         MVI   0(R2),C'V'                                               01052
FM1RECF1 LA    R2,1(R2)                                                 01053
         TM    DS1RECFM,DCBRECTO                                        01054
         BZ    FM1RECF2                                                 01055
         MVI   0(R2),C'T'                                               01056
         LA    R2,1(R2)                                                 01057
FM1RECF2 TM    DS1RECFM,DCBRECBR                                        01058
         BZ    FM1RECF3                                                 01059
         MVI   0(R2),C'B'                                               01060
         LA    R2,1(R2)                                                 01061
FM1RECF3 TM    DS1RECFM,DCBRECSB                                        01062
         BZ    FM1RECF4                                                 01063
         MVI   0(R2),C'S'                                               01064
         LA    R2,1(R2)                                                 01065
FM1RECF4 TM    DS1RECFM,DCBRECCC                                        01066
         BNM   FM1BLKSZ                                                 01067
         TM    DS1RECFM,DCBRECCA                                        01068
         MVI   0(R2),C'A'                                               01069
         BO    FM1BLKSZ                                                 01070
         MVI   0(R2),C'M'                                               01071
         SPACE 1                                                        01072
FM1BLKSZ LA    R2,DS1BLKL                                               01073
         BAL   R14,CONVERT2                                             01074
         MVC   L1BLKSIZ,CONVEDIT+7                                      01075
         SPACE 1                                                        01076
         LA    R2,DS1LRECL                                              01077
         BAL   R14,CONVERT2                                             01078
         MVC   L1LRECL,CONVEDIT+7                                       01079
         SPACE 1                                                        01080
         LA    R2,DS1KEYL                                               01081
         BAL   R14,CONVERT1                                             01082
         MVC   L1KEYLEN,CONVEDIT+9                                      01083
         SPACE 1                                                        01084
         UNPK  TRAREA,DS1OPTCD(8)                                       01085
         TR    TRAREA,TRTABLE                                           01086
         MVC   L1OPTCD,TRAREA                                           01087
         SPACE 1                                                        01088
         L     R0,F1TRKAL                                               01089
         BAL   R14,CONVERT                                              01090
         MVC   L1TRKAL,CONVEDIT+7                                       01091
         SPACE 1                                                        01092
         CLC   DS1LSTAR(5),ZEROES                                       01093
         BE    FM1NOEPV                                                 01094
         LH    R0,DS1LSTAR                                              01095
         N     R0,=X'0000FFFF'  TURN OFF HIGH ORDER BYTES    LMN-CBT    01096
         CLI   DS1LSTAR+2,0                                             01097
         BE    *+8                                                      01098
         AH    R0,=H'1'                                                 01099
         BAL   R14,CONVERT                                              01100
         MVC   L1TRKUS,CONVEDIT+7                                       01101
         SPACE 1                                                        01102
FM1NOEPV LA    R2,DS1NOEPV                                              01103
         BAL   R14,CONVERT1                                             01104
         MVC   L1NOEPV,CONVEDIT+10                                      01105
         SPACE 1                                                        01106
         LA    R2,DS1SCALO+1                                            01107
         BAL   R14,CONVERT3                                             01108
         MVC   L1SECQU,CONVEDIT+7                                       01109
         C     R0,=F'99999'                                             01110
         BNH   FM1SCALO                                                 01111
         MVC   L1SECQU,STARS                                            01112
         SPACE 1                                                        01113
FM1SCALO TM    DS1SCALO,X'C0'                                           01114
         BNO   FM1SCAL1                                                 01115
         MVI   L1TYP,C'C'                                               01116
         B     FM1SCAL4                                                 01117
FM1SCAL1 BNZ   FM1SCAL2                                                 01118
         MVI   L1TYP,C'A'                                               01119
         B     FM1SCAL4                                                 01120
FM1SCAL2 TM    DS1SCALO,X'80'                                           01121
         BO    FM1SCAL3                                                 01122
         MVI   L1TYP,C'B'                                               01123
         B     FM1SCAL4                                                 01124
FM1SCAL3 MVI   L1TYP,C'T'                                               01125
FM1SCAL4 LA    R2,L1TYP+1                                               01126
         TM    DS1SCALO,X'08'                                           01127
         BZ    FM1SCAL5                                                 01128
         MVI   0(R2),C'C'                                               01129
         LA    R2,1(,R2)                                                01130
FM1SCAL5 TM    DS1SCALO,X'04'                                           01131
         BZ    FM1SCAL6                                                 01132
         MVI   0(R2),C'M'                                               01133
         LA    R2,1(,R2)                                                01134
FM1SCAL6 TM    DS1SCALO,X'02'                                           01135
         BZ    FM1SCAL7                                                 01136
         MVI   0(R2),C'A'                                               01137
         LA    R2,1(,R2)                                                01138
FM1SCAL7 TM    DS1SCALO,X'01'                                           01139
         BZ    FM1OPTS                                                  01140
         MVI   0(R2),C'R'                                               01141
         SPACE 1                                                        01142
FM1OPTS  MVI   BUF,SPACE1AP                                             01143
         TM    PARMOPT1,EMPTYOPT     TEST FOR "EMPTY" OPTION            01144
         BO    FM1EM1         IF REQUEST GO TO PROCESS IT               01145
         TM    PARMOPT2,MODELOPT   TEST FOR "MODEL" OPTION              01146
         BZ    FM1SKTS0   IF NOT MODEL BYPASS..                         01147
*                                                                       01148
FM1EM1   CLC   DS1LSTAR(5),ZEROES   TEST FOR TTR ZEROED...NOT VALID     01149
         BE    FM1DONXT              IF ALL ZERO...BYPASS               01150
         CLI   DS1LSTAR+2,0         TEST FOR A TTR OF RECORD ZERO       01151
         BNE   FM1DONXT             IF NOT ZERO, NON-EMPTY DSN          01152
         CLC   NUMEXT,ZEROES        TEST FOR ANY VALID EXTENTS          01153
         BNE   FM1EM2              IF NOT ZERO...EMPTY DATASET.         01154
         TM    PARMOPT2,MODELOPT    CHECK FOR "MODEL" OPTION SELECTED   01155
         BO    FM1SKTS0      IF SELECTED...PRINT THIS ENTRY             01156
         B     FM1DONXT    IF NOT MODEL...DON'T INCLUDE IT AS "EMPTY"   01157
FM1EM2   TM    PARMOPT1,EMPTYOPT     CHECK FOR OPTION OF "EMPTY"        01158
         BZ    FM1DONXT  IF NOT SELECTED...DON'T PRINT                  01159
*                                                                       01160
FM1SKTS0 EQU  *                                                         01161
         TM    PARMOPT1,DUMPOPT                                         01162
         BO    FM1XTRAL                                                 01163
         TM    PARMOPT1,EXTNTOPT                                        01164
         BZ    FM1SKTS1                                                 01165
         CLC   NUMEXT,ZEROES                                            01166
         BNE   FM1XTRAL                                                 01167
FM1SKTS1 TM    PARMOPT2,ISAMOPT                                         01168
         BZ    FM1SKTS2                                                 01169
         LTR   R7,R7                                                    01170
         BNZ   FM1XTRAL                                                 01171
FM1SKTS2 TM    PARMOPT1,PDSOPT                                          01172
         BZ    FM1GOPRT                                                 01173
         TM    DS1DSORG,DCBDSGPO                                        01174
         BZ    FM1GOPRT                                                 01175
FM1XTRAL MVI   BUF,SPACE2AP                                             01176
FM1GOPRT BAL   R14,PRINT                                                01177
         SPACE 1                                                        01178
FM1SKTS3 EQU   *                                                        01179
         TM    PARMOPT1,DUMPOPT                                         01180
         BZ    FM1EXDMP                                                 01181
         LA    R2,DS1                                                   01182
         LA    R3,DS1FDAD                                               01183
         BAL   R14,DUMPDSCB                                             01184
         LTR   R7,R7                                                    01185
         BZ    FM1DMP3                                                  01186
         LA    R2,DS2                                                   01187
         LA    R3,DS2FDAD                                               01188
         BAL   R14,DUMPDSCB                                             01189
FM1DMP3  LTR   R8,R8                                                    01190
         BZ    FM1EXDMP                                                 01191
         LA    R2,DS3                                                   01192
         LA    R3,DS3FDAD                                               01193
         BAL   R14,DUMPDSCB                                             01194
         SPACE 1                                                        01195
FM1EXDMP TM    PARMOPT1,EXTNTOPT                                        01196
         BZ    FM1PDSDP                                                 01197
         CLC   NUMEXT,ZEROES                                            01198
         BE    FM1PDSDP                                                 01199
         MVC   BUF+10(L'HEAD2DAT),HEAD2DAT                              01200
         MVI   BUF,SPACE0AP                                             01201
         BAL   R14,PRINT                                                01202
         MVC   BUF+10(L'HEAD2UND),HEAD2UND                              01203
         MVI   BUF,SPACE1AP                                             01204
         BAL   R14,PRINT                                                01205
         L     R2,LISTEXT                                               01206
         LA    R3,BUF+9                                                 01207
         SR    R4,R4                                                    01208
         MVI   EXPFLAG,X'FF'                                            01209
         SPACE 1                                                        01210
FM1EXLP  BAL   R14,EXFORMAT                                             01211
         LA    R4,4(,R4)                                                01212
         L     R2,LISTEXT(R4)                                           01213
         LTR   R2,R2                                                    01214
         BZ    FM1EXLST                                                 01215
         BAL   R14,PRINT                                                01216
         B     FM1EXLP                                                  01217
FM1EXLST MVI   BUF,SPACE2AP                                             01218
         BAL   R14,PRINT                                                01219
         SPACE 1                                                        01220
FM1PDSDP TM    PARMOPT1,PDSOPT                                          01221
         BZ    FM1ISDMP                                                 01222
         TM    DS1DSORG,DCBDSGPO                                        01223
         BZ    FM1ISDMP                                                 01224
         LA    R2,DS1                                                   01225
         BAL   R14,PDSLIST                                              01226
         SPACE 1                                                        01227
FM1ISDMP TM    PARMOPT2,ISAMOPT                                         01228
         BZ    FM1DONXT                                                 01229
         BAL   R14,ISAMLIST                                             01230
FM1DONXT B     FM1PRLOP                                                 01231
*                                                                       01232
* G.D.F. ROUTINE TO CONVERT INPUT & OUTPUT DATES TO                     01233
* SAME FORMAT AS CREDAT & EXPDAT FOR DATEDIT ROUTINE                    01234
*                                                                       01235
BINARY   UNPK  DASAVE(3),0(2,R2)  G.D.F.                                01236
         PACK  DATEWORD,DASAVE(2)  G.D.F.                               01237
         CVB   R1,DATEWORD    G.D.F.                                    01238
         STC   R1,0(R2)       G.D.F.                                    01239
         ZAP   DATEWORD,1(2,R2)  G.D.F.                                 01240
         CVB   R1,DATEWORD    G.D.F.                                    01241
         STH   R1,DATEWORD    G.D.F.                                    01242
         MVC   1(2,R2),DATEWORD  G.D.F.                                 01243
         BR    R14            G.D.F.                                    01244
*                                                                       01245
* END OF BINARY CONVERT ROUTINE                                         01246
*                                                                       01247
         SPACE 2                                                        01248
FM1PREND MVI   BUF,SPACE1IM                                             01249
         BAL   R14,PRINT                                                01250
         MVI   BUF+1,C' '          MOVE TO BLANK OUT LINE               01251
         MVC   BUF+2(131),BUF+1    BLANK OUT PRINT LINE                 01252
         MVC   BUF+49(14),=C'<<<<< END VTOC'                            01253
         LH    R0,FM1COUNT                                              01254
         BAL   R14,CONVERT                                              01255
         MVC   BUF+64(4),CONVEDIT+8                                     01256
         MVC   BUF+69(15),=C'DATA SETS >>>>>'                           01257
         MVI   BUF,SPACE3AP                                             01258
         BAL   R14,PRINT                                                01259
         SPACE 1                                                        01260
         TM    PARMOPT2,SMAPOPT                                         01261
         BO    MAPPRINT                                                 01262
         TM    PARMOPT1,MAPOPT+DIRFLAG                                  01263
         BZ    MAPEND                                                   01264
         SPACE 1                                                        01265
         DROP  R6,R7,R8                                                 01266
         EJECT                                                          01267
MAPPRINT MVC   CURLINES,=H'999'                                         01268
         LA    R0,HEAD2A                                                01269
         ST    R0,BUFPTR                                                01270
         MVI   HEADMID,C' '                                             01271
         MVC   HEADMID+1(81),HEADMID                                    01272
         MVC   HEAD2VOL,VOLSERNO                                        01273
         MVC   HEADMID(40),HEAD2                                        01274
         L     R6,HOOKSTRT                                              01275
         USING EXTENT,R6                                                01276
         L     R4,=F'-1'                                                01277
         SR    R5,R5                                                    01278
         MVI   EXPFLAG,0                                                01279
         SPACE 1                                                        01280
MAPPRLOP CLC   EXTLCCHH,HOOKEND                                         01281
         BE    MAPPREND                                                 01282
         CLC   EXTHITT,TRKSPVOL                                         01283
         BNL   MAPINVAL                                                 01284
         CLC   EXTLOTT,EXTHITT                                          01285
         BH    MAPINVAL                                                 01286
         CLI   EXTTYPE,X'80'                                            01287
         BE    MAPGETEX                                                 01288
         LH    R0,EXTLOTT                                               01289
         N     R0,=X'0000FFFF'  ZERO OUT HIGH ORDER BYTES   LMN-CBT     01290
         SR    R0,R4                                                    01291
         S     R0,=F'1'                                                 01292
         BZ    MAPTRGET                                                 01293
         BP    MAPTRMIS                                                 01294
         BAL   R14,CONVERT                                              01295
         MVC   BUF+1(5),CONVEDIT+7                                      01296
         MVC   BUF+7(14),=C'TRACKS OVERLAP'                             01297
         CH    R4,EXTHITT                                               01298
         BNL   *+8                                                      01299
MAPTRGET LH    R4,EXTHITT                                               01300
         N     R4,=X'0000FFFF'  ZERO OUT HIGH ORDER BYTES   LMN-CBT     01301
         AH    R5,EXTNOTRK                                              01302
         N     R5,=X'0000FFFF'  ZERO OUT HIGH ORDER BYTES   LMN-CBT     01303
         B     MAPGETEX                                                 01304
         SPACE 1                                                        01305
MAPINVAL MVC   BUF+7(14),=C'INVALID EXTENT'                             01306
         B     MAPGETEX                                                 01307
         SPACE 1                                                        01308
MAPTRMIS BAL   R14,CONVERT                                              01309
         MVC   BUF+1(5),CONVEDIT+7                                      01310
         MVC   BUF+7(14),=C'TRACKS MISSING'                             01311
         MVI   BUF,SPACE1AP                                             01312
         BAL   R14,PRINT                                                01313
         B     MAPTRGET                                                 01314
         SPACE 1                                                        01315
MAPGETEX LA    R2,EXTENT                                                01316
         LA    R3,BUF+22                                                01317
         BAL   R14,EXFORMAT                                             01318
         MVC   SEEKBUF(133),BUF                                         01319
         BAL   R14,PRINT                                                01320
         TM    PARMOPT2,SMAPOPT                                         01321
         BZ    *+8                                                      01322
         BAL   R14,MAPSEEK                                              01323
         L     R6,EXTPTR                                                01324
         B     MAPPRLOP                                                 01325
         SPACE 3                                                        01326
MAPPREND LH    R0,TRKSPVOL                                              01327
         SR    R0,R4                                                    01328
         S     R0,=F'1'                                                 01329
         BNP   MAPNOMIS                                                 01330
         BAL   R14,CONVERT                                              01331
         MVC   BUF+1(5),CONVEDIT+7                                      01332
         MVC   BUF+7(40),=C'TRACKS MISSING OR ASSIGNED AS ALTERNATES'   01333
         MVI   BUF,SPACE1AP                                             01334
         BAL   R14,PRINT                                                01335
MAPNOMIS MVI   BUF,SPACE1IM                                             01336
         BAL   R14,PRINT                                                01337
         N     R5,=X'0000FFFF'  ZERO OUT HIGH ORDER BYTES   LMN-CBT     01338
         LR    R0,R5                                                    01339
         BAL   R14,CONVERT                                              01340
         MVC   BUF+59(5),CONVEDIT+7                                     01341
         MVC   BUF+66(20),=C'TRACKS ACCOUNTED FOR'                      01342
         MVI   BUF,SPACE2AP                                             01343
         BAL   R14,PRINT                                                01344
         BAL   R14,MAPSEEKA        ERROR TRACKS                         01345
         MVC   BUF+59(28),=C'<<<<< END OF TRACK MAP >>>>>'              01346
         MVI   BUF,SPACE0AP                                             01347
         BAL   R14,PRINT                                                01348
MAPEND   B     NEXTVOL                                                  01349
         SPACE 1                                                        01350
         DROP  R6                                                       01351
         EJECT                                                          01352
MAPSEEK  STM   R14,R12,VOLSAVE                                          01353
         TR    SEEKBUF+23(20),SEEKTABL                                  01354
         SR    R14,R14                                                  01355
         ICM   R15,15,SEEKBUF+34                                        01356
         SLL   R15,4                                                    01357
         SLDL  R14,4                                                    01358
         SLL   R15,4                                                    01359
         SLDL  R14,4                                                    01360
         SLL   R15,4                                                    01361
         SLDL  R14,4                                                    01362
         SLL   R15,4                                                    01363
         SLDL  R14,4                                                    01364
         ST    R14,SEEKCYL                                              01365
         SR    R14,R14                                                  01366
         ICM   R15,15,SEEKBUF+39                                        01367
         SLL   R15,4                                                    01368
         SLDL  R14,4                                                    01369
         SLL   R15,4                                                    01370
         SLDL  R14,4                                                    01371
         SLL   R15,4                                                    01372
         SLDL  R14,4                                                    01373
         SLL   R15,4                                                    01374
         SLDL  R14,4                                                    01375
         ST    R14,SEEKTRK                                              01376
         SR    R14,R14                                                  01377
         ICM   R15,15,SEEKBUF+23                                        01378
         SLL   R15,4                                                    01379
         SLDL  R14,4                                                    01380
         SLL   R15,4                                                    01381
         SLDL  R14,4                                                    01382
         SLL   R15,4                                                    01383
         SLDL  R14,4                                                    01384
         SLL   R15,4                                                    01385
         SLDL  R14,4                                                    01386
         LR    R5,R14                                                   01387
         SR    R14,R14                                                  01388
         ICM   R15,15,SEEKBUF+28                                        01389
         SLL   R15,4                                                    01390
         SLDL  R14,4                                                    01391
         SLL   R15,4                                                    01392
         SLDL  R14,4                                                    01393
         SLL   R15,4                                                    01394
         SLDL  R14,4                                                    01395
         SLL   R15,4                                                    01396
         SLDL  R14,4                                                    01397
         LR    R7,R14                                                   01398
         LA    R6,MAXCYL                                                01399
         LR    R4,R5               CYL                                  01400
         SLL   R4,7                X 128                                01401
         LR    R1,R7               TRK                                  01402
         SLL   R1,2                X 4                                  01403
         AR    R1,R4                                                    01404
         L     R4,VOLTAB           VOL TAB ADDR                         01405
         LA    R4,0(R1,R4)         SLOT ADDR                            01406
         EJECT                                                          01407
MAPSEEK0 SR    R8,R8               TOTAL                                01408
         ST    R5,SEEKCURR                                              01409
         SPACE 1                                                        01410
MAPSEEK1 C     R5,SEEKCYL          END OF EXTENT (CYL)                  01411
         BL    MAPSEEK2            NO                                   01412
         BH    MAPSEEK3            YES                                  01413
         C     R7,SEEKTRK          END OF EXTENT (TRK)                  01414
         BH    MAPSEEK3            YES                                  01415
         SPACE 1                                                        01416
MAPSEEK2 A     R8,0(0,R4)          TOTAL TRACK ACCESS COUNT             01417
         LA    R4,4(0,R4)          NEXT TRK                             01418
         LA    R7,1(0,R7)                                               01419
         C     R7,=A(MAXTRK)       MAX TRKS PER CYL                     01420
         BL    MAPSEEK1                                                 01421
         SPACE 1                                                        01422
MAPSEEK3 LTR   R15,R8              TOTAL FOR CYL                        01423
         BZ    MAPSEEK4            ZERO, NO PRINT                       01424
         M     R14,=F'100'                                              01425
         D     R14,VOLSEEK                                              01426
         SLL   R14,1                                                    01427
         C     R14,VOLSEEK         ROUND UP                             01428
         BL    *+8                 NO                                   01429
         LA    R15,1(0,R15)                                             01430
         CVD   R15,SEEKDBL                                              01431
         MVI   SEEKBUF+1,C' '                                           01432
         MVC   SEEKBUF+2(131),SEEKBUF+1                                 01433
         MVC   SEEKBUF+1(3),=CL3'CYL'                                   01434
         UNPK  SEEKBUF+5(4),SEEKCURR+2(3)                               01435
         MVI   SEEKBUF+8,C' '                                           01436
         NC    SEEKBUF+5(3),=3X'0F'                                     01437
         TR    SEEKBUF+5(3),=C'0123456789ABCDEF'                        01438
         MVC   SEEKBUF+8(5),=X'402021206C'                              01439
         ED    SEEKBUF+8(4),SEEKDBL+6                                   01440
         SRL   R15,1                                                    01441
         CH    R15,=H'50'          MAX                                  01442
         BNH   *+8                 NO                                   01443
         LH    R15,=H'50'          SET MAX                              01444
         EX    R15,PCTMVE          GRAPHIC PERCENT                      01445
         LA    R15,SEEKBUF+15(R15)                                      01446
         MVI   0(R15),C'>'                                              01447
         MVC   BUF(133),SEEKBUF                                         01448
         BAL   R14,PRINT                                                01449
         SPACE 1                                                        01450
MAPSEEK4 C     R5,SEEKCYL          END OF EXTENT (CYL)                  01451
         BL    MAPSEEK5            NO                                   01452
         BH    MAPSEEK6            YES                                  01453
         C     R7,SEEKTRK          END OF EXTENT (TRK)                  01454
         BNL   MAPSEEK6            YES                                  01455
         SPACE 1                                                        01456
MAPSEEK5 LA    R5,1(0,R5)          NEXT CYL                             01457
         SR    R7,R7               TRK 0                                01458
         BCT   R6,MAPSEEK0                                              01459
         SPACE 1                                                        01460
MAPSEEK6 LM    R14,R12,VOLSAVE                                          01461
         BR    R14                                                      01462
         SPACE 1                                                        01463
PCTMVE   MVC   SEEKBUF+15(0),PCTLINE                                    01464
         EJECT                                                          01465
MAPSEEKA STM   R14,R12,VOLSAVE                                          01466
         L     R4,VOLTAB           VOL TAB ADDR                         01467
         LA    R4,124(0,R4)                                             01468
         SR    R5,R5                                                    01469
         LA    R6,MAXCYL                                                01470
         SPACE 1                                                        01471
MAPSEEKB ST    R5,SEEKCURR                                              01472
         L     R8,0(0,R4)          ERROR TRACK ACCESS COUNT             01473
         LA    R4,128(0,R4)        NEXT TRK                             01474
         SPACE 1                                                        01475
MAPSEEKC LTR   R15,R8              TOTAL FOR CYL                        01476
         BZ    MAPSEEKD            ZERO, NO PRINT                       01477
         M     R14,=F'100'                                              01478
         D     R14,VOLSEEK                                              01479
         SLL   R14,1                                                    01480
         C     R14,VOLSEEK         ROUND UP                             01481
         BL    *+8                 NO                                   01482
         LA    R15,1(0,R15)                                             01483
         CVD   R15,SEEKDBL                                              01484
         MVI   SEEKBUF+1,C' '                                           01485
         MVC   SEEKBUF+2(131),SEEKBUF+1                                 01486
         MVC   SEEKBUF+1(3),=CL3'CYL'                                   01487
         UNPK  SEEKBUF+5(4),SEEKCURR+2(3)                               01488
         MVI   SEEKBUF+8,C' '                                           01489
         NC    SEEKBUF+5(3),=3X'0F'                                     01490
         TR    SEEKBUF+5(3),=C'0123456789ABCDEF'                        01491
         MVC   SEEKBUF+8(5),=X'402021206C'                              01492
         ED    SEEKBUF+8(4),SEEKDBL+6                                   01493
         SRL   R15,1                                                    01494
         CH    R15,=H'50'          MAX                                  01495
         BNH   *+8                 NO                                   01496
         LH    R15,=H'50'          SET MAX                              01497
         EX    R15,PCTMVE          GRAPHIC PERCENT                      01498
         LA    R15,SEEKBUF+15(R15)                                      01499
         MVI   0(R15),C'>'                                              01500
         MVC   BUF(133),SEEKBUF                                         01501
         BAL   R14,PRINT                                                01502
         SPACE 1                                                        01503
MAPSEEKD LA    R5,1(0,R5)          NEXT CYL                             01504
         BCT   R6,MAPSEEKB                                              01505
         MVC   BUF(133),SEEKEMSG                                        01506
         SR    R14,R14                                                  01507
         L     R15,VOLSAMP                                              01508
         CVD   R15,SEEKDBL                                              01509
         MVC   BUF+22(6),=X'402020202120'                               01510
         ED    BUF+22(6),SEEKDBL+5                                      01511
         L     R15,VOLSEEK                                              01512
         M     R14,=F'100'                                              01513
         D     R14,VOLSAMP                                              01514
         CVD   R15,SEEKDBL                                              01515
         MVC   BUF+7(4),=X'40202120'                                    01516
         ED    BUF+7(4),SEEKDBL+6                                       01517
         BAL   R14,PRINT                                                01518
         LM    R14,R12,VOLSAVE                                          01519
         BR    R14                                                      01520
         EJECT                                                          01521
ERRNODD  TM    PARMOPT2,VOLSOPT                                         01522
         BNO   NEXTDD                                                   01523
         MVC   BUF+41(19),=C'CANNOT FIND DD CARD'                       01524
         B     ERRCON1                                                  01525
         SPACE 1                                                        01526
ERRNOTDA TM    PARMOPT2,VOLSOPT                                         01527
         BNO   NEXTDD                                                   01528
         MVC   BUF+41(27),=C'DEVICE IS NOT DIRECT ACCESS'               01529
         B     ERRCON1                                                  01530
         SPACE 1                                                        01531
ERRUNKDV MVC   BUF+41(19),=C'UNKNOWN DEVICE TYPE'                       01532
         B     ERRCON1                                                  01533
         SPACE 1                                                        01534
ERRNOPEN MVC   BUF+41(27),=C'ATTEMPT TO OPEN VTOC FAILED'               01535
         B     ERRCON1                                                  01536
         SPACE 1                                                        01537
ERRCON1  MVC   BUF+10(28),=C'ERROR CONCERNING "VOLUME01":'              01538
         MVC   BUF+28(8),VOLDDNAM                                       01539
         MVI   BUF,SPACE3AP                                             01540
         BAL   R14,PRINT                                                01541
         LA    R0,4                                                     01542
         B     ERRCODST                                                 01543
         SPACE 1                                                        01544
ERRNOTFX MVC   BUF+41(33),=C'BAD DSCB - SHOULD HAVE BEEN TYPE'          01545
         MVC   BUF+75(1),BADDSTYP                                       01546
         LR    R2,R8                                                    01547
         B     ERRCON2                                                  01548
         SPACE 1                                                        01549
ERRNOCOR MVC   BUF+41(41),=C'INSUFFICIENT MEMORY TO COMPLETE VTOC LIST' 01550
         SR    R2,R2                                                    01551
         B     ERRCON2                                                  01552
         SPACE 1                                                        01553
ERRCON2  BAL   R14,CLOSVTOC                                             01554
         BAL   R14,DEQVTOC                                              01555
         MVC   BUF+10(28),=C'ERROR CONCERNING "VOLUME01":'              01556
         MVC   BUF+28(8),VOLDDNAM                                       01557
         MVI   BUF,SPACE3AP                                             01558
         BAL   R14,PRINT                                                01559
         LTR   R2,R2                                                    01560
         BZ    ERRNODMP                                                 01561
         LA    R3,DS4FDAD-DS4(R2)                                       01562
         BAL   R14,DUMPDSCB                                             01563
ERRNODMP LA    R0,8                                                     01564
ERRCODST C     R0,RETCODE                                               01565
         BL    *+8                                                      01566
         ST    R0,RETCODE                                               01567
         B     NEXTVOL                                                  01568
         EJECT                                                          01569
*                                                                       01570
*        SUBROUTINES START HERE                                         01571
*                                                                       01572
PDSLIST  ST    R14,PDSAVE                                               01573
         STM   R2,R6,PDSAVE+4                                           01574
         USING DS1,R2                                                   01575
         MVC   JFCBDSNM,DS1DSNAM                                        01576
         SR    R0,R0                                                    01577
         IC    R0,DS1NOBDB                                              01578
         BAL   R14,CONVERT                                              01579
         DROP  R2                                                       01580
         MVC   PDSVAL4,CONVEDIT+9                                       01581
         SPACE 1                                                        01582
         OPEN  (PDSDCB),TYPE=J                                          01583
         L     R3,PDSBLKAD+4                                            01584
         READ  PDSDECB,SF,,(3),MF=E                                     01585
         SPACE 1                                                        01586
         SR    R0,R0                                                    01587
         STH   R0,PDSBYTCT                                              01588
         STH   R0,PDSBLKAL                                              01589
         STH   R0,PDSBLKUS                                              01590
         STH   R0,PDSMEMCT                                              01591
PDSNEXT  LH    R0,PDSBYTCT                                              01592
         LTR   R0,R0                                                    01593
         BP    PDSPRINT                                                 01594
         CHECK PDSDECB                                                  01595
         SPACE 1                                                        01596
         CLI   SYNADFLG,0                                               01597
         BE    PDSREDOK                                                 01598
         MVC   BUF+28(11),=CL11'DIRECTORY.'                             01599
         MVI   BUF,SPACE3AP                                             01600
         BAL   R14,PRINT                                                01601
         CLI   SYNADFLG,X'FF'                                           01602
         BE    PDSEOD                                                   01603
         BAL   R14,ABDUMP                                               01604
         SPACE 1                                                        01605
PDSREDOK LM    R2,R3,PDSBLKAD                                           01606
         XR    R2,R3                                                    01607
         XR    R3,R2                                                    01608
         XR    R2,R3                                                    01609
         STM   R2,R3,PDSBLKAD                                           01610
         READ  PDSDECB,SF,,(3),MF=E                                     01611
         SPACE 1                                                        01612
         USING PDS,R2                                                   01613
         LH    R1,PDSBLKAL                                              01614
         LA    R1,1(R1)                                                 01615
         STH   R1,PDSBLKAL                                              01616
         LH    R0,PDSCOUNT                                              01617
         SH    R0,=H'2'                                                 01618
         STH   R0,PDSBYTCT                                              01619
         LA    R1,PDSENTRY                                              01620
         ST    R1,PDSENTAD                                              01621
         B     PDSNEXT                                                  01622
         SPACE 1                                                        01623
         DROP  R2                                                       01624
         SPACE 3                                                        01625
PDSPRINT L     R6,PDSENTAD                                              01626
         USING PDSENTRY,R6                                              01627
         IC    R2,PDSINDIC                                              01628
         N     R2,=A(PDSUSERH)                                          01629
         SLL   R2,1                                                     01630
         LR    R1,R6                                                    01631
         AR    R1,R2                                                    01632
         LA    R1,12(R1)                                                01633
         ST    R1,PDSENTAD                                              01634
         LH    R1,PDSBYTCT                                              01635
         SR    R1,R2                                                    01636
         SH    R1,=Y(PDSUSERD-PDSENTRY)                                 01637
         STH   R1,PDSBYTCT                                              01638
         CLC   PDSNAME,EFFS                                             01639
         BNE   PDSMEMOK                                                 01640
         MVC   PDSBLKUS,PDSBLKAL                                        01641
         B     PDSNEXT                                                  01642
PDSMEMOK LH    R1,PDSMEMCT                                              01643
         LA    R1,1(R1)                                                 01644
         STH   R1,PDSMEMCT                                              01645
         MVC   BUF+12(8),PDSNAME                                        01646
         TM    PDSINDIC,PDSALIAS                                        01647
         BZ    *+8                                                      01648
         MVI   BUF+21,C'A'                                              01649
         UNPK  TRAREA,PDSTTRP(8)                                        01650
         TR    TRAREA,TRTABLE                                           01651
         MVC   BUF+23(4),TRAREA                                         01652
         MVI   BUF+27,C'.'                                              01653
         MVC   BUF+28(2),TRAREA+4                                       01654
         IC    R0,PDSINDIC                                              01655
         N     R0,=A(PDS#TTRS)                                          01656
         SRL   R0,5                                                     01657
         STC   R0,BUF+32                                                01658
         OI    BUF+32,X'F0'                                             01659
         LR    R5,R2                                                    01660
         CH    R2,=H'44'                                                01661
         BNH   PDSPRLIN                                                 01662
         LA    R2,2                                                     01663
         BAL   R14,PRLKAHED                                             01664
         LR    R2,R5                                                    01665
         LA    R5,44                                                    01666
PDSPRLIN LA    R3,PDSUSERD                                              01667
         LA    R4,BUF+35                                                01668
         BAL   R14,DUMPLINE                                             01669
         MVI   BUF,SPACE1AP                                             01670
         BAL   R14,PRINT                                                01671
         CH    R2,=H'44'                                                01672
         BNH   PDSNEXT                                                  01673
         LR    R5,R2                                                    01674
         SH    R5,=H'44'                                                01675
         LA    R3,PDSUSERD+44                                           01676
         LA    R4,BUF+35                                                01677
         BAL   R14,DUMPLINE                                             01678
         MVI   BUF,SPACE1AP                                             01679
         BAL   R14,PRINT                                                01680
         B     PDSNEXT                                                  01681
         SPACE 1                                                        01682
         DROP  R6                                                       01683
         SPACE 2                                                        01684
PDSEOD   CLOSE (PDSDCB)                                                 01685
         CLI   SYNADFLG,0                                               01686
         MVI   SYNADFLG,0                                               01687
         BNE   PDSRETRN                                                 01688
         LH    R0,PDSMEMCT                                              01689
         BAL   R14,CONVERT                                              01690
         MVC   PDSVAL1,CONVEDIT+8                                       01691
         LH    R0,PDSBLKUS                                              01692
         BAL   R14,CONVERT                                              01693
         MVC   PDSVAL2,CONVEDIT+8                                       01694
         LH    R0,PDSBLKAL                                              01695
         BAL   R14,CONVERT                                              01696
         MVC   PDSVAL3,CONVEDIT+8                                       01697
         MVC   BUF+10(PDSMSGLN),PDSMSG                                  01698
         MVI   BUF,SPACE3AP                                             01699
         BAL   R14,PRINT                                                01700
PDSRETRN LM    R2,R6,PDSAVE+4                                           01701
         L     R14,PDSAVE                                               01702
         BR    R14                                                      01703
         EJECT ,                                                        01704
         SPACE 1                                                        01705
         USING DS2,R7                                                   01706
ISAMLIST LTR   R7,R7                                                    01707
         BZR   R14                                                      01708
         ST    R14,ISAVE                                                01709
         STM   R2,R5,ISAVE+4                                            01710
         SPACE 1                                                        01711
         MVC   BUF+12(19),=C'NO OF INDEX LEVELS='                       01712
         LA    R2,DS2NOLEV                                              01713
         BAL   R14,CONVERT1                                             01714
         MVC   BUF+31(3),CONVERTD                                       01715
         SPACE 1                                                        01716
         MVC   BUF+42(19),=C'FLAGGED FOR DELETE='                       01717
         LA    R2,DS2TAGDT                                              01718
         BAL   R14,CONVERT2                                             01719
         MVC   BUF+61(5),CONVERTD                                       01720
         SPACE 1                                                        01721
         MVC   BUF+72(19),=C'TRKS FOR HIGH INDX='                       01722
         LA    R2,DS2NOTRK                                              01723
         BAL   R14,CONVERT1                                             01724
         MVC   BUF+91(3),CONVERTD                                       01725
         SPACE 1                                                        01726
         MVC   BUF+102(19),=C'IND OVFL TRKS LEFT='                      01727
         LA    R2,DS2RORG2                                              01728
         BAL   R14,CONVERT2                                             01729
         MVC   BUF+121(5),CONVERTD                                      01730
         MVI   BUF,SPACE1AP                                             01731
         BAL   R14,PRINT                                                01732
         SPACE 1                                                        01733
         MVC   BUF+12(19),=C'TRKS FOR MAST INDX='                       01734
         LA    R2,DS2DVIND                                              01735
         BAL   R14,CONVERT1                                             01736
         MVC   BUF+31(3),CONVERTD                                       01737
         SPACE 1                                                        01738
         MVC   BUF+42(19),=C'OVERFLOW  ACCESSES='                       01739
         LA    R2,DS2RORG3                                              01740
         BAL   R14,CONVERT3                                             01741
         MVC   BUF+61(8),CONVERTD                                       01742
         SPACE 1                                                        01743
         MVC   BUF+72(19),=C'PRIME DATA RECORDS='                       01744
         LA    R2,DS2PRCTR                                              01745
         BAL   R14,CONVERT4                                             01746
         MVC   BUF+91(10),CONVERTD                                      01747
         SPACE 1                                                        01748
         MVC   BUF+102(19),=C'NO OF OVFL RECORDS='                      01749
         LA    R2,DS2OVRCT                                              01750
         BAL   R14,CONVERT2                                             01751
         MVC   BUF+121(5),CONVERTD                                      01752
         MVI   BUF,SPACE1AP                                             01753
         BAL   R14,PRINT                                                01754
         SPACE 1                                                        01755
         MVC   BUF+12(19),=C'CYL OVFL  TRKS/CYL='                       01756
         LA    R2,DS2CYLOV                                              01757
         BAL   R14,CONVERT1                                             01758
         MVC   BUF+31(3),CONVERTD                                       01759
         SPACE 1                                                        01760
         MVC   BUF+42(19),=C'CORE FOR HIGH INDX='                       01761
         LA    R2,DS2NOBYT                                              01762
         BAL   R14,CONVERT2                                             01763
         MVC   BUF+61(5),CONVERTD                                       01764
         SPACE 1                                                        01765
         MVC   BUF+72(19),=C'IND OFL BYTES LEFT='                       01766
         LA    R2,DS2BYOVL                                              01767
         BAL   R14,CONVERT2                                             01768
         MVC   BUF+91(5),CONVERTD                                       01769
         SPACE 1                                                        01770
         MVC   BUF+102(19),=C'FULL CYLOVFL AREAS='                      01771
         LA    R2,DS2RORG1                                              01772
         BAL   R14,CONVERT2                                             01773
         MVC   BUF+121(5),CONVERTD                                      01774
         MVI   BUF,SPACE2AP                                             01775
         BAL   R14,PRINT                                                01776
         SPACE 1                                                        01777
         LM    R2,R5,ISAVE+4                                            01778
         L     R14,ISAVE                                                01779
         BR    R14                                                      01780
         DROP  R7                                                       01781
         EJECT                                                          01782
         SPACE 1                                                        01783
         USING EXTENT,R2                                                01784
         USING EXLINE,R3                                                01785
         SPACE 1                                                        01786
EXFORMAT LTR   R2,R2               ANY EXTENT.Q                         01787
         BZR   R14                 RETURN IMM IF NOT                    01788
         ST    R14,EXSAVE                                               01789
         STM   R2,R3,EXSAVE+4                                           01790
         SPACE 1                                                        01791
         UNPK  TRAREA,EXTLCCHH(8)                                       01792
         TR    TRAREA,TRTABLE                                           01793
         MVC   EXLFCC,TRAREA                                            01794
         MVI   EXLFPRD,C'.'                                             01795
         MVC   EXLFHH,TRAREA+4                                          01796
         SPACE 1                                                        01797
         UNPK  TRAREA,EXTHCCHH(8)                                       01798
         TR    TRAREA,TRTABLE                                           01799
         MVC   EXLLCC,TRAREA                                            01800
         MVI   EXLLPRD,C'.'                                             01801
         MVC   EXLLHH,TRAREA+4                                          01802
         SPACE 1                                                        01803
         LH    R0,EXTLOTT                                               01804
         N     R0,=X'0000FFFF'  ZERO OUT HIGH ORDER BYTES   LMN-CBT     01805
         BAL   R14,CONVERT                                              01806
         MVC   EXLFTT,CONVEDIT+7                                        01807
         SPACE 1                                                        01808
         LH    R0,EXTHITT                                               01809
         N     R0,=X'0000FFFF'  ZERO OUT HIGH ORDER BYTES   LMN-CBT     01810
         BAL   R14,CONVERT                                              01811
         MVC   EXLLTT,CONVEDIT+7                                        01812
         SPACE 1                                                        01813
         LH    R0,EXTNOTRK                                              01814
         BAL   R14,CONVERT                                              01815
         MVC   EXLNOTRK,CONVEDIT+7                                      01816
         SPACE 1                                                        01817
         CLI   EXPFLAG,0                                                01818
         BNE   EXPTYPE                                                  01819
         L     R1,EXTIDPTR                                              01820
         MVC   EXLDSNAM,0(R1)                                           01821
         SPACE 1                                                        01822
EXPTYPE  CLI   EXTTYPE,X'01'       IS THIS A DATA EXTENT.Q              01823
         BNE   EXPNDATA            NO, GO CHECK OTHERS                  01824
         CLI   EXPFLAG,0           ARE WE MAPPING.Q                     01825
         BE    EXPEXTPR            YES, DON'T CLUTTER UP                01826
         MVC   EXLTYPE,=C'PRIM'    ELSE MOVE IN EXTENT TYPE             01827
         B     EXPEXTPR                                                 01828
         SPACE 1                                                        01829
EXPNDATA TM    EXTTYPE,X'F0'       VOL LABEL, OR TYPE 4, 5, OR 6        01830
         BO    EXPCKFMX            BR IF YES                            01831
         CLI   EXTTYPE,X'02'       ISAM OVERFLOW.Q                      01832
         MVC   EXLTYPE,=C'OVFL'                                         01833
         BE    EXPEXTPR                                                 01834
         SPACE 1                                                        01835
         CLI   EXTTYPE,X'04'       ISAM INDEX.Q                         01836
         MVC   EXLTYPE,=C'INDX'                                         01837
         BE    EXPEXTPR                                                 01838
         SPACE 1                                                        01839
         CLI   EXTTYPE,X'40'       USER LABEL TRACK.Q                   01840
         MVC   EXLTYPE,=C'ULBL'                                         01841
         BE    EXPEXTPR                                                 01842
         SPACE 1                                                        01843
         CLI   EXTTYPE,X'81'       CYLS OF DATA ON CYL BDRY.Q           01844
         MVC   EXLTYPE,=C'CYLB'                                         01845
         BE    EXPEXTPR                                                 01846
         SPACE 1                                                        01847
         CLI   EXTTYPE,X'80'       SHARING AN EXTENT.Q                  01848
         MVC   EXLTYPE,=C'SHRD'                                         01849
         BNE   EXPCKFMX                                                 01850
         CLI   EXPFLAG,0           ARE WE MAPPING.Q                     01851
         BNE   EXPEXTPR            NO, DON'T ENCLOSE IN PARENS          01852
         MVI   EXLLPARN,C'('                                            01853
         MVI   EXLRPARN,C')'                                            01854
         B     EXPEXTPR                                                 01855
         SPACE 1                                                        01856
EXPCKFMX CLI   EXTTYPE,C'5'        FREE EXTENT.Q                        01857
         BE    EXPPRLIN                                                 01858
         SPACE 1                                                        01859
         CLI   EXTTYPE,C'4'        VTOC EXTENT.Q                        01860
         MVC   EXLTYPE,=C'VTOC'                                         01861
         BE    EXPEXTPR                                                 01862
         SPACE 1                                                        01863
         CLI   EXTTYPE,X'FF'       VOLUME LABEL.Q                       01864
         MVC   EXLTYPE,=C'VLBL'                                         01865
         BE    EXPPRLIN                                                 01866
         SPACE 1                                                        01867
         CLI   EXTTYPE,C'6'        SHARED EXTENT.Q                      01868
         MVC   EXLTYPE,=C'*UN*'                                         01869
         BNE   EXPEXTPR                                                 01870
         SPACE 1                                                        01871
         MVC   EXLTYPE,=C'SPLT'                                         01872
         SR    R0,R0                                                    01873
         IC    R0,EXTSEQNO                                              01874
         BAL   R14,CONVERT                                              01875
         MVC   EXLSPLIT(3),CONVEDIT+9                                   01876
         B     EXPPRLIN                                                 01877
         SPACE 1                                                        01878
EXPEXTPR SR    R0,R0                                                    01879
         IC    R0,EXTSEQNO                                              01880
         AH    R0,=H'1'                                                 01881
         BAL   R14,CONVERT                                              01882
         MVC   EXLSEQNO,CONVEDIT+10                                     01883
         SPACE 1                                                        01884
EXPPRLIN MVI   BUF,SPACE1AP                                             01885
         LM    R2,R3,EXSAVE+4                                           01886
         L     R14,EXSAVE                                               01887
         BR    R14                                                      01888
         DROP  R2,R3                                                    01889
         EJECT                                                          01890
         SPACE 3                                                        01891
VTOCREAD ST    R14,VTSAVE                                               01892
         STM   R2,R4,VTSAVE+4                                           01893
         L     R2,RENEXT@                                               01894
         CHECK (2)                                                      01895
         LA    R1,=CL11'VTOC READ.'                                     01896
         BAL   R14,SYNADCHK                                             01897
         SPACE 1                                                        01898
         USING DS1,R3                                                   01899
VTOCREOK XC    0(20,R2),0(R2)                                           01900
         LA    R4,20(R2)                                                01901
         MVC   DS1(DS1END-DS1),0(R4)                                    01902
         MVC   DS1FDAD(3),VTOCMBB                                       01903
         MVC   DS1FDAD+3(4),VTOCCCHH                                    01904
         MVC   DS1FDAD+7(1),VTOCR                                       01905
         CLC   HWMDS1,DS1FDAD+3                                         01906
         BL    VTOCEOD                                                  01907
         SPACE 1                                                        01908
         READ  (2),SF,VTOCDCB,(4),MF=E                                  01909
         A     R2,REBLKSIZ                                              01910
         ST    R2,RENEXT@                                               01911
         L     R1,RECOUNT                                               01912
         BCT   R1,VTSAVECT                                              01913
         L     R2,REBLOCK@                                              01914
         ST    R2,RENEXT@                                               01915
         L     R1,RENCP                                                 01916
VTSAVECT ST    R1,RECOUNT                                               01917
         SPACE 1                                                        01918
         LA    R0,1                                                     01919
         SR    R1,R1                                                    01920
         IC    R1,VTOCR                                                 01921
         AR    R1,R0                                                    01922
         STC   R1,VTOCR                                                 01923
         CH    R1,VTDSCBTR                                              01924
         BNH   VTOCREND                                                 01925
         MVI   VTOCR,1                                                  01926
         AH    R0,VTOCTT                                                01927
         STH   R0,VTOCTT                                                01928
         LR    R1,R0                                                    01929
         BAL   R14,TTCONVRT                                             01930
         MVC   VTOCCCHH,CCHH                                            01931
         SPACE 1                                                        01932
VTOCREND L     R14,VTSAVE                                               01933
         LM    R2,R4,VTSAVE+4                                           01934
         LA    R14,4(R14)                                               01935
         BR    R14                                                      01936
         SPACE 1                                                        01937
VTOCEOD  L     R14,VTSAVE                                               01938
         LM    R2,R4,VTSAVE+4                                           01939
         BR    R14                                                      01940
         SPACE 1                                                        01941
         DROP  R3                                                       01942
         EJECT                                                          01943
         SPACE 3                                                        01944
OBTAIN   MVC   OBCCHHR,0(R2)                                            01945
         OBTAIN OBCAMLST                                                01946
         BXLE  R15,R15,*+8                                              01947
         BAL   R14,ABDUMP                                               01948
         USING DS1,R3                                                   01949
         MVC   DS1(DS1END-DS1),CAMLIST                                  01950
         MVC   DS1FDAD(3),VTOCMBB                                       01951
         MVC   DS1FDAD+3(5),0(R2)                                       01952
         BR    R14                                                      01953
         SPACE 2                                                        01954
OBCAMLST CAMLST SEEK,OBCCHHR,VOLSERNO,CAMLIST                           01955
         SPACE 1                                                        01956
         DROP  R3                                                       01957
         EJECT                                                          01958
         SPACE 3                                                        01959
SYNADXIT SYNADAF ACSMETH=BSAM                                           01960
         MVC   BUF+7(47),=C'I/O ERROR PROCESSING XXXXXXXXXX. SYNADAF INX01961
               FO="'                                                    01962
         MVC   BUF+54(78),50(R1)                                        01963
         MVI   BUF+132,C'"'                                             01964
         SYNADRLS                                                       01965
         MVI   SYNADFLG,X'FF'                                           01966
         LTR   R0,R0                                                    01967
         BZR   R14                                                      01968
         MVI   SYNADFLG,1                                               01969
         BR    R14                                                      01970
         SPACE 3                                                        01971
SYNADCHK CLI   SYNADFLG,0                                               01972
         BER   R14                                                      01973
         MVC   BUF+28(11),0(R1)                                         01974
         BAL   R14,CLOSVTOC                                             01975
         BAL   R14,DEQVTOC                                              01976
         MVI   BUF,SPACE3IM                                             01977
         BAL   R14,PRINT                                                01978
         MVI   BUF,SPACE3AP                                             01979
         BAL   R14,PRINT                                                01980
         CLI   SYNADFLG,X'FF'                                           01981
         BE    ERRNODMP                                                 01982
         BAL   R14,ABDUMP                                               01983
         EJECT                                                          01984
         SPACE 3                                                        01985
DEQGATE  EQU   *+1                                                      01986
DEQVTOC  BCR   *-*+15,R14                                               01987
         OI    DEQGATE,X'F0'                                            01988
         SPACE 1                                                        01989
         DEQ   MF=(E,ENQVTOC)                                           01990
         SPACE 1                                                        01991
         BR    R14                                                      01992
         SPACE 4                                                        01993
         SPACE 1                                                        01994
CLOSVTOC CLOSE MF=(E,CLOSLIST)                                          01995
         SPACE 1                                                        01996
         L     R1,REBLOCK@                                              01997
         LTR   R1,R1                                                    01998
         BZR   R14                                                      01999
         L     R0,REGETSIZ                                              02000
         FREEMAIN R,LV=(0),A=(1)                                        02001
         SR    R0,R0                                                    02002
         ST    R0,REBLOCK@                                              02003
         BR    R14                                                      02004
         EJECT                                                          02005
         SPACE 3                                                        02006
         USING DS1,R6                                                   02007
         USING DS3,R8                                                   02008
         SPACE 1                                                        02009
F13HOOK  ST    R14,F1SAVE                                               02010
         SR    R5,R5                                                    02011
         ST    R5,F1TRKAL                                               02012
         STH   R5,NUMEXT                                                02013
         XC    LISTEXT(17*4),LISTEXT                                    02014
         IC    R5,DS1NOEPV                                              02015
         CLI   DS1EXT1,X'40'                                            02016
         BNE   *+8                                                      02017
         AH    R5,=H'1'                                                 02018
         LTR   R5,R5                                                    02019
         BZR   R14                                                      02020
         STH   R5,NUMEXT                                                02021
         SPACE 1                                                        02022
         SR    R3,R3                                                    02023
         SR    R4,R4                                                    02024
F1NXTEXT EX    0,F1EXTPIK(R3)                                           02025
         BAL   R14,F1EXTCNV                                             02026
         AR    R4,R0                                                    02027
         MVC   HOOKLCCH(8),2(R2)                                        02028
         STH   R0,HOOKNTRK                                              02029
         MVC   HOOKTYPE(2),0(R2)                                        02030
         MVC   HOOKLOTT(4),LOWTT                                        02031
         LA    R0,DS1DSNAM                                              02032
         ST    R0,HOOKIDPT                                              02033
         LA    R2,HOOKPTR                                               02034
         BAL   R14,HOOKUP                                               02035
         ST    R15,LISTEXT(R3)                                          02036
         LA    R3,4(R3)                                                 02037
         BCT   R5,F1NXTEXT                                              02038
         ST    R4,F1TRKAL                                               02039
         L     R14,F1SAVE                                               02040
         BR    R14                                                      02041
         EJECT ,                                                        02042
         SPACE 3                                                        02043
F1EXTCNV CLI   0(R2),0                                                  02044
         BER   R14                                                      02045
         LA    R2,2(R2)                                                 02046
         BAL   R15,CCHHCONV                                             02047
         STH   R0,LOWTT                                                 02048
         LA    R2,4(R2)                                                 02049
         BAL   R15,CCHHCONV                                             02050
         STH   R0,HIGHTT                                                02051
         LH    R1,LOWTT                                                 02052
         N     R1,=X'0000FFFF'  ZERO OUT HIGH ORDER BYTES   LMN-CBT     02053
         SR    R0,R1                                                    02054
         AH    R0,=H'1'                                                 02055
         S     R2,=F'6'                                                 02056
         BR    R14                                                      02057
         SPACE 2                                                        02058
F1EXTPIK LA    R2,DS1EXT1                                               02059
         LA    R2,DS1EXT2                                               02060
         LA    R2,DS1EXT3                                               02061
         LA    R2,DS3EXTNT                                              02062
         LA    R2,DS3EXTNT+10                                           02063
         LA    R2,DS3EXTNT+20                                           02064
         LA    R2,DS3EXTNT+30                                           02065
         LA    R2,DS3ADEXT                                              02066
         LA    R2,DS3ADEXT+10                                           02067
         LA    R2,DS3ADEXT+20                                           02068
         LA    R2,DS3ADEXT+30                                           02069
         LA    R2,DS3ADEXT+40                                           02070
         LA    R2,DS3ADEXT+50                                           02071
         LA    R2,DS3ADEXT+60                                           02072
         LA    R2,DS3ADEXT+70                                           02073
         LA    R2,DS3ADEXT+80                                           02074
         SPACE 2                                                        02075
         DROP  R6,R8                                                    02076
         EJECT                                                          02077
         SPACE 3                                                        02078
         USING DS5,R8                                                   02079
*        USING DS6,R8                                                   02080
F56HOOK  ST    R14,F5SAVE                                               02081
         LA    R2,DS5AVEXT                                              02082
         LA    R3,8                                                     02083
         BAL   R14,F5EXTCNV                                             02084
         LA    R2,5(R2)                                                 02085
         BCT   R3,*-8                                                   02086
         LA    R2,DS5MAVET                                              02087
         LA    R3,18                                                    02088
         BAL   R14,F5EXTCNV                                             02089
         LA    R2,5(R2)                                                 02090
         BCT   R3,*-8                                                   02091
         L     R14,F5SAVE                                               02092
         BR    R14                                                      02093
         SPACE 1                                                        02094
F5EXTCNV ST    R14,F5SAVE+4                                             02095
         STM   R2,R5,F5SAVE+8                                           02096
         CLC   0(5,R2),ZEROES                                           02097
         BER   R14                                                      02098
         MVC   FMT5TT(4),0(R2)                                          02099
         LH    R3,FMT5TT                                                02100
         STH   R3,LOWTT                                                 02101
         LH    R4,FMT5CYLS                                              02102
         SR    R5,R5                                                    02103
         IC    R5,4(R2)                                                 02104
         CLI   DS5FMTID,C'6'                                            02105
         BE    F6HOOK                                                   02106
         LH    R1,AVAILEXT                                              02107
         LA    R1,1(R1)                                                 02108
         STH   R1,AVAILEXT                                              02109
         LH    R0,AVAILCYL                                              02110
         AR    R0,R4                                                    02111
         STH   R0,AVAILCYL                                              02112
         LA    R0,=CL44'  **** AVAILABLE ****'                          02113
         ST    R0,HOOKIDPT                                              02114
         MVI   HOOKSEQN,0                                               02115
         LR    R0,R4                                                    02116
         MH    R0,TRKSPCYL                                              02117
         AR    R0,R5                                                    02118
         STH   R0,HOOKNTRK                                              02119
         CH    R0,F5LARGTT                                              02120
         BNH   F5AVAIL                                                  02121
         STH   R0,F5LARGTT                                              02122
         MVC   F5LARGST,2(R2)                                           02123
F5AVAIL  LR    R1,R0                                                    02124
         AH    R1,AVAILSPC                                              02125
         STH   R1,AVAILSPC                                              02126
         EJECT ,                                                        02127
         SPACE 3                                                        02128
F6RETURN AR    R0,R3                                                    02129
         BCTR  R0,0                                                     02130
         STH   R0,HIGHTT                                                02131
         LH    R1,LOWTT                                                 02132
         BAL   R14,TTCONVRT                                             02133
         MVC   HOOKLCCH,CCHH                                            02134
         LH    R1,HIGHTT                                                02135
         BAL   R14,TTCONVRT                                             02136
         MVC   HOOKHCCH,CCHH                                            02137
         MVC   HOOKLOTT(4),LOWTT                                        02138
         MVC   HOOKTYPE,DS5FMTID                                        02139
         LA    R2,HOOKPTR                                               02140
         BAL   R14,HOOKUP                                               02141
         LM    R2,R5,F5SAVE+8                                           02142
         L     R14,F5SAVE+4                                             02143
         BR    R14                                                      02144
         SPACE 1                                                        02145
F6HOOK   STC   R5,HOOKSEQN                                              02146
         MVC   HOOKIDPT,=A(FMT6MSG)                                     02147
         LR    R0,R4                                                    02148
         MH    R0,TRKSPCYL                                              02149
         STH   R0,HOOKNTRK                                              02150
         B     F6RETURN                                                 02151
         SPACE 1                                                        02152
         DROP  R8                                                       02153
         EJECT                                                          02154
         SPACE 3                                                        02155
HOOKUP   TM    PARMOPT1,MAPOPT+EXTNTOPT+DIRFLAG                         02156
         BZR   R14                                                      02157
         ST    R14,HOSAVE                                               02158
         STM   R3,R5,HOSAVE+4                                           02159
         LA    R4,EXTNTLEN                                              02160
         BAL   R14,GETCORE                                              02161
         USING EXTENT,R3                                                02162
         MVC   EXTENT(EXTNTLEN),0(R2)                                   02163
         L     R2,HOOKSTRT                                              02164
         LA    R4,HOOKSTRT                                              02165
HOOKLOOK CLC   EXTLCCHH,EXTLCCHH-EXTENT(R2)                             02166
         BL    HOOKDONE                                                 02167
         LR    R4,R2                                                    02168
         L     R2,0(R2)                                                 02169
         B     HOOKLOOK                                                 02170
         SPACE 1                                                        02171
HOOKDONE ST    R2,EXTPTR                                                02172
         ST    R3,EXTPTR-EXTENT(R4)                                     02173
         LR    R15,R3                                                   02174
         LM    R3,R5,HOSAVE+4                                           02175
         L     R14,HOSAVE                                               02176
         BR    R14                                                      02177
         SPACE 1                                                        02178
         DROP  R3                                                       02179
         EJECT ,                                                        02180
         SPACE 3                                                        02181
CCHHCONV SR    R0,R0                                                    02182
         IC    R0,0(R2)                                                 02183
         MH    R0,DEVCONV1                                              02184
         SR    R1,R1                                                    02185
         IC    R1,1(R2)                                                 02186
         MH    R1,DEVCONV2                                              02187
         AR    R0,R1                                                    02188
         SR    R1,R1                                                    02189
         IC    R1,2(R2)                                                 02190
         MH    R1,DEVCONV3                                              02191
         AR    R0,R1                                                    02192
         SR    R1,R1                                                    02193
         IC    R1,3(R2)                                                 02194
         MH    R1,DEVCONV4                                              02195
         AR    R0,R1                                                    02196
         BR    R15                                                      02197
         SPACE 4                                                        02198
TTCONVRT SR    R0,R0                                                    02199
         ST    R0,CCHH                                                  02200
         LH    R15,DEVCONV1                                             02201
         LTR   R15,R15                                                  02202
         BZ    TTCONVR2                                                 02203
         DR    R0,R15                                                   02204
         STC   R1,CCHH                                                  02205
         LR    R1,R0                                                    02206
         SR    R0,R0                                                    02207
TTCONVR2 LH    R15,DEVCONV2                                             02208
         LTR   R15,R15                                                  02209
         BZ    TTCONVR3                                                 02210
         DR    R0,R15                                                   02211
         STC   R1,CCHH+1                                                02212
         LR    R1,R0                                                    02213
         SR    R0,R0                                                    02214
TTCONVR3 LH    R15,DEVCONV3                                             02215
         LTR   R15,R15                                                  02216
         BZ    TTCONVR4                                                 02217
         DR    R0,R15                                                   02218
         STC   R1,CCHH+2                                                02219
         STC   R0,CCHH+3                                                02220
         BR    R14                                                      02221
         SPACE 1                                                        02222
TTCONVR4 STC   R1,CCHH+3                                                02223
         BR    R14                                                      02224
         EJECT                                                          02225
         SPACE 3                                                        02226
CONVERT1 LA    R3,1                                                     02227
         B     CONVCOM                                                  02228
         SPACE 1                                                        02229
CONVERT2 LA    R3,2                                                     02230
         B     CONVCOM                                                  02231
         SPACE 1                                                        02232
CONVERT3 LA    R3,3                                                     02233
         B     CONVCOM                                                  02234
         SPACE 1                                                        02235
CONVERT4 LA    R3,4                                                     02236
         SPACE 1                                                        02237
CONVCOM  SR    R0,R0                                                    02238
CONV1MOR SLL   R0,8                                                     02239
         IC    R0,0(R2)                                                 02240
         LA    R2,1(R2)                                                 02241
         BCT   R3,CONV1MOR                                              02242
         SPACE 1                                                        02243
CONVERT  LPR   R0,R0                                                    02244
         CVD   R0,CONVDEC                                               02245
         UNPK  CONVUNPK,CONVDEC                                         02246
         OI    CONVUNPK+11,X'F0'                                        02247
         MVC   CONVEDIT,=X'402020202020202020202120'                    02248
         ED    CONVEDIT,CONVDEC+2                                       02249
         MVC   CONVERTD,CONVEDIT+1                                      02250
CONVCLI  CLI   CONVERTD,C' '                                            02251
         BNER  R14                                                      02252
         MVC   CONVERTD,CONVERTD+1                                      02253
         B     CONVCLI                                                  02254
         SPACE 1                                                        02255
         EJECT                                                          02256
         SPACE 3                                                        02257
DATEDIT  ST    R14,DASAVE                                               02258
         STM   R2,R5,DASAVE+4                                           02259
         XC    DATEWORD,DATEWORD                                        02260
         LTR   R2,R2                                                    02261
         BZ    DATGET                                                   02262
         SR    R1,R1                                                    02263
         IC    R1,0(R2)                                                 02264
         MH    R1,=H'1000'                                              02265
         MVC   DATEWORD,1(R2)                                           02266
         AH    R1,DATEWORD                                              02267
         CVD   R1,DATEWORD                                              02268
DATGETRT OI    DATEWORD+7,X'0F'                                         02269
         L     R2,DATEWORD+4                                            02270
         SR    R0,R0                                                    02271
         D     R0,=F'1000'                                              02272
         LA    R15,DATNORMY                                             02273
         LTR   R14,R1                                                   02274
         BZ    DATCOMP                                                  02275
         N     R14,=F'3'                                                02276
         BM    DATCOMP                                                  02277
         LA    R15,DATLEAPY                                             02278
         SPACE 1                                                        02279
DATCOMP  LTR   R0,R0                                                    02280
         BZ    DAJULIAN                                                 02281
         CH    R0,0(R15)                                                02282
         BH    DAJULIAN                                                 02283
         TM    PARMOPT2,JDATEOPT                                        02284
         BO    DAJULIAN                                                 02285
         LA    R3,1                                                     02286
         SR    R14,R14                                                  02287
         SPACE 1                                                        02288
DATICMON IC    R14,1(R3,R15)                                            02289
         CR    R0,R14                                                   02290
         BNH   DATMONOK                                                 02291
         SR    R0,R14                                                   02292
         LA    R3,1(R3)                                                 02293
         B     DATICMON                                                 02294
         SPACE 1                                                        02295
DATMONOK MH    R3,=H'1000'                                              02296
         AR    R3,R0                                                    02297
         MH    R3,=H'1000'                                              02298
         AR    R3,R1                                                    02299
         CVD   R3,DATEWORD                                              02300
         MVC   DATEWORD(5),DATEWORD+3                                   02301
         UNPK  DATEWORD(8),DATEWORD(5)                                  02302
         OI    DATEWORD+7,X'F0'                                         02303
         MVI   DATEWORD+2,C'/'                                          02304
         MVI   DATEWORD+5,C'/'                                          02305
         SPACE 3                                                        02306
DATRETRN LM    R2,R5,DASAVE+4                                           02307
         MVC   0(8,R3),DATEWORD                                         02308
         L     R14,DASAVE                                               02309
         BR    R14                                                      02310
         SPACE 2                                                        02311
DAJULIAN ST    R2,DATEWORD                                              02312
         UNPK  DATEWORD+2(5),DATEWORD+1(3)                              02313
         MVC   DATEWORD+1(2),DATEWORD+2                                 02314
         MVI   DATEWORD,C' '                                            02315
         MVI   DATEWORD+3,C'.'                                          02316
         MVI   DATEWORD+7,C' '                                          02317
         B     DATRETRN                                                 02318
         SPACE 2                                                        02319
DATGET   ST    R1,DATEWORD+4                                            02320
         LTR   R1,R1                                                    02321
         BNZ   DATGOT                                                   02322
         TIME  DEC                                                      02323
         ST    R1,DATEWORD+4                                            02324
DATGOT   CVB   R1,DATEWORD                                              02325
         B     DATGETRT                                                 02326
         SPACE 2                                                        02327
         EJECT                                                          02328
         SPACE 3                                                        02329
DUMPDSCB ST    R14,DUSAVE                                               02330
         LR    R4,R2                                                    02331
         LA    R2,3                                                     02332
         BAL   R14,PRLKAHED                                             02333
         LR    R2,R4                                                    02334
         MVC   BUF+8(17),=C'BLK 1234.5678.90:'                          02335
         UNPK  TRAREA,3(8,R3)                                           02336
         TR    TRAREA,TRTABLE                                           02337
         MVC   BUF+12(4),TRAREA                                         02338
         MVC   BUF+17(4),TRAREA+4                                       02339
         MVC   BUF+22(2),TRAREA+8                                       02340
         LA    R3,0(R2)                                                 02341
         LA    R4,BUF+35                                                02342
         LA    R5,44                                                    02343
         BAL   R14,DUMPLINE                                             02344
         MVI   BUF,SPACE1AP                                             02345
         BAL   R14,PRINT                                                02346
         MVC   BUF+8(13),=C'FORMAT N DSCB'                              02347
         MVC   BUF+15(1),44(R2)                                         02348
         OI    BUF+15,X'F0'                                             02349
         LA    R3,44(R2)                                                02350
         LA    R4,BUF+26                                                02351
         LA    R5,48                                                    02352
         BAL   R14,DUMPLINE                                             02353
         MVI   BUF,SPACE1AP                                             02354
         BAL   R14,PRINT                                                02355
         LA    R3,92(R2)                                                02356
         LA    R4,BUF+26                                                02357
         LA    R5,48                                                    02358
         BAL   R14,DUMPLINE                                             02359
         MVI   BUF,SPACE2AP                                             02360
         BAL   R14,PRINT                                                02361
         L     R14,DUSAVE                                               02362
         BR    R14                                                      02363
         EJECT ,                                                        02364
         SPACE 3                                                        02365
DUMPLINE LTR   R5,R5                                                    02366
         BNPR  R14                                                      02367
         B     DUMPNEXT                                                 02368
DUMPWORD BCT   R1,DUMPBYTE                                              02369
         MVI   0(R4),C' '                                               02370
         LA    R4,1(R4)                                                 02371
DUMPNEXT LA    R1,4                                                     02372
DUMPBYTE UNPK  TRAREA(3),0(2,R3)                                        02373
         TR    TRAREA(2),TRTABLE                                        02374
         MVC   0(2,R4),TRAREA                                           02375
         LA    R3,1(R3)                                                 02376
         LA    R4,2(R4)                                                 02377
         BCT   R5,DUMPWORD                                              02378
         BR    R14                                                      02379
         EJECT                                                          02380
         SPACE 3                                                        02381
GETCORE  A     R4,=F'3'                                                 02382
         N     R4,=F'-4'                                                02383
GETAGAIN L     R0,CORLEFT                                               02384
         SR    R0,R4                                                    02385
         BM    GETMAIN                                                  02386
         ST    R0,CORLEFT                                               02387
         L     R3,CORNEXT@                                              02388
         LR    R0,R3                                                    02389
         AR    R0,R4                                                    02390
         ST    R0,CORNEXT@                                              02391
         BR    R14                                                      02392
         SPACE 3                                                        02393
GETMAIN  L     R3,CURBLK@                                               02394
         GETMAIN EC,LV=2048,A=CURBLK@                                   02395
         BXH   R15,R15,ERRNOCOR                                         02396
         SPACE 1                                                        02397
         L     R1,CURBLK@                                               02398
         ST    R1,0(R3)                                                 02399
         SR    R0,R0                                                    02400
         ST    R0,0(R1)                                                 02401
         LA    R1,4(R1)                                                 02402
         ST    R1,CORNEXT@                                              02403
         MVC   CORLEFT,=A(2044)                                         02404
         B     GETAGAIN                                                 02405
         EJECT ,                                                        02406
         SPACE 3                                                        02407
FREECORE L     R2,CORFRST@                                              02408
FREELOOP LTR   R1,R2                                                    02409
         BZ    FREEDONE                                                 02410
         L     R2,0(R2)                                                 02411
         LA    R0,2048                                                  02412
         FREEMAIN R,LV=(0),A=(1)                                        02413
         B     FREELOOP                                                 02414
         SPACE 1                                                        02415
FREEDONE SR    R0,R0                                                    02416
         ST    R0,CORLEFT                                               02417
         ST    R0,CORFRST@                                              02418
         LA    R0,CORFRST@                                              02419
         ST    R0,CURBLK@                                               02420
         BR    R14                                                      02421
         EJECT                                                          02422
         SPACE 3                                                        02423
PRINT    ST    R14,PRSAVE                                               02424
         STM   R2,R5,PRSAVE+4                                           02425
         LH    R0,CURLINES                                              02426
         CH    R0,MAXLINES                                              02427
         BL    PRNOPAGE                                                 02428
         PUT   PRINTDCB,NEWPAGE                                         02429
         SR    R0,R0                                                    02430
         STH   R0,CURLINES                                              02431
PRNOPAGE LTR   R0,R0                                                    02432
         BNZ   PRINTBUF                                                 02433
         LH    R0,CURPAGES                                              02434
         AH    R0,=H'1'                                                 02435
         STH   R0,CURPAGES                                              02436
         CH    R0,MAXPAGES                                              02437
         BNH   PRTPGCNV                                                 02438
         SR    R0,R0                                                    02439
         STH   R0,CURPAGES                                              02440
PRTPGCNV BAL   R14,CONVERT                                              02441
         MVC   PAGENO,CONVERTD                                          02442
         PUT   PRINTDCB,HEADERCC                                        02443
         MVC   CURLINES,=H'3'                                           02444
         L     R2,BUFPTR                                                02445
PRNXTBUF LH    R0,CURLINES                                              02446
         LTR   R2,R2                                                    02447
         BZ    PRINTBUF                                                 02448
         AH    R0,4(R2)                                                 02449
         STH   R0,CURLINES                                              02450
         LA    R3,6(R2)                                                 02451
         PUT   PRINTDCB,(3)                                             02452
         L     R2,0(R2)                                                 02453
         B     PRNXTBUF                                                 02454
         EJECT                                                          02455
         SPACE 3                                                        02456
PRINTBUF TM    BUF,X'80'                                                02457
         BZ    PRUPLINE                                                 02458
         SR    R0,R0                                                    02459
         B     PRDOPUT                                                  02460
PRUPLINE SR    R14,R14                                                  02461
         IC    R14,BUF                                                  02462
         SRL   R14,3                                                    02463
         AR    R0,R14                                                   02464
PRDOPUT  STH   R0,CURLINES                                              02465
         PUT   PRINTDCB,BUF                                             02466
         TM    BUF,X'02'                                                02467
         BO    PRETURN                                                  02468
         MVI   BUF+1,C' '                                               02469
         MVC   BUF+2(131),BUF+1                                         02470
         SPACE 1                                                        02471
PRETURN  LM    R2,R5,PRSAVE+4                                           02472
         L     R14,PRSAVE                                               02473
         BR    R14                                                      02474
         SPACE 4                                                        02475
PRLKAHED AH    R2,CURLINES                                              02476
         CH    R2,MAXLINES                                              02477
         BNHR  R14                                                      02478
         MVC   CURLINES,=H'999'                                         02479
         BR    R14                                                      02480
         EJECT                                                          02481
         SPACE 1                                                        02482
RETURN   CLOSE (PRINTDCB)                                               02483
         SPACE 1                                                        02484
         TM    DCBBUFCB+3+(PRINTDCB-IHADCB),X'01'                       02485
         BO    RETQUIT                                                  02486
         FREEPOOL PRINTDCB                                              02487
         SPACE 1                                                        02488
RETQUIT  CLI   HDNGLIST,X'FF'                                           02489
         BNE   RETSAVER                                                 02490
         L     R1,HDNGLIST                                              02491
         LH    R2,0(R1)                                                 02492
         LH    R0,CURPAGES                                              02493
         AH    R0,=H'1'                                                 02494
         BAL   R14,CONVERT                                              02495
         LA    R3,CONVEDIT+12                                           02496
         SR    R3,R2                                                    02497
         BCTR  R2,0                                                     02498
         STC   R2,*+5                                                   02499
         MVC   2(*-*,R1),0(R3)                                          02500
         SPACE 1                                                        02501
RETSAVER L     R13,SAVEAREA+4                                           02502
         L     R15,RETCODE                                              02503
         L     R14,12(R13)                                              02504
         LM    R0,R12,20(R13)                                           02505
         MVI   12(R13),X'FF'                                            02506
         SPM   R14                                                      02507
         BR    R14                                                      02508
         SPACE 3                                                        02509
ABDUMP   OI    ABCODE,X'80'        SET DUMP FLAG                        02510
         SPACE 1                                                        02511
ABEND    L     R1,ABCODE           PICK UP ABEND CODE                   02512
         ABEND (1)                                                      02513
         EJECT ,                                                        02514
NEWPAGE  DC    AL1(EJECTIM)                                             02515
HEADERCC DC    AL1(SPACE3AP)                                            02516
VOLSERNO DS    CL6                 CURRENT VOLUME SERIAL                02517
         ORG   VOLSERNO                                                 02518
HEADER DS 0CL95                                                         02519
       DC C'DIRECT-ACCESS VOLUME SEEK ANALYSIS .....            '       02520
       DC C'   PAS. VERSION--'                                          02521
       DC C'&SYSDATE'   8 CHARS                                         02522
       DC CL31' '                                                       02523
HEADMID  EQU   HEADER+19                                                02524
PRDATE   DC    CL8'03/15/84'                                            02525
         DC    CL6'  DAY='                                              02526
PRDAY    DC    CL3'999'                                                 02527
PRTIME   DC    CL7'  23:59',CL4' '                                      02528
         DC    CL5'PAGE '                                               02529
PAGENO   DC    CL4'9999'                                                02530
         SPACE 3                                                        02531
HEAD1    DC    C'TABLE OF CONTENTS FOR VOLUME "'                        02532
HEAD1VOL DC    CL6'XXXXXX',C'" ON DEVICE "'                             02533
HEAD1UCB DC    CL3'XXX',C'" MOUNTED AS "'                               02534
HEAD1MT  DC    CL8'XXXXXXXX',C'/'                                       02535
HEAD1MTR DC    CL5'XXXXX',C'"'                                          02536
HEAD1A   DC    A(HEAD1B)                                                02537
         DC    H'0'                                                     02538
HEADER1  DC    AL1(SPACE0AP),CL19' ',CL26'DSNAME'                       02539
HEADAT1A DC    C'SERIAL R/W  REFDT    CREDT    EXPDT   DSO RFM BLKSZ LRX02540
               ECL KEY OP TRKAL TRKUS EX SECQU T'                       02541
HEAD1B   DC    A(0)                                                     02542
         DC    H'2'                                                     02543
HEADER2  DC    AL1(SPACE2AP),44C'_',C' '                                02544
HEADAT1B DC    C'______ ___ ________ ________ ________ ___ ___ _____ __X02545
               ___ ___ __ _____ _____ __ _____ _'                       02546
         SPACE 2                                                        02547
HEAD2    DC    C'TRACK ALLOCATION MAP FOR VOLUME "'                     02548
HEAD2VOL DC    C'XXXXXX',C'"'                                           02549
HEAD2A   DC    A(HEAD2B)                                                02550
         DC    H'0'                                                     02551
         DC    AL1(SPACE0AP),CL22' '                                    02552
HEAD2DAT DC    C'FIRST TRK   LAST TRK  FIRST   LAST  #TRKS  EX  EX-#  ' 02553
         DC    CL44'DSNAME OR USAGE'                                    02554
         DC    CL13' '                                                  02555
HEAD2B   DC    A(0)                                                     02556
         DC    H'2'                                                     02557
         DC    AL1(SPACE2AP),CL22' '                                    02558
HEAD2UND DC    C'_________  _________  _____  _____  _____  __  ____  ' 02559
         DC    44C'_'                                                   02560
         DC    CL13' '                                                  02561
PDSMSG   DC    CL19'DIRECTORY CONTAINS'                                 02562
PDSVAL1  DC    CL4'0000'                                                02563
         DC    CL18' MEMBERS AND USES '                                 02564
PDSVAL2  DC    CL4'0000'                                                02565
         DC    CL8' OF THE '                                            02566
PDSVAL3  DC    CL4'0000'                                                02567
         DC    CL39' DIRECTORY BLOCKS ALLOCATED, INCLUDING '            02568
PDSVAL4  DC    CL3'000'                                                 02569
         DC    CL24' BYTES OF THE LAST BLOCK'                           02570
PDSMSGLN EQU   *-PDSMSG                                                 02571
         EJECT                                                          02572
VTOCDCB  DCB   DDNAME=VOLUME01,                                        X02573
               DSORG=PS,                                               X02574
               MACRF=(R),                                              X02575
               RECFM=FS,                                               X02576
               KEYLEN=44,                                              X02577
               BLKSIZE=96,                                             X02578
               OPTCD=C,                                                X02579
               NCP=NCPDFLT,                                            X02580
               EXLST=JFCBAD,                                           X02581
               EODAD=VTOCEOD,                                          X02582
               SYNAD=SYNADXIT                                           02583
         SPACE 8                                                        02584
PDSDCB   DCB   DDNAME=VOLUME01,                                        X02585
               DSORG=PS,                                               X02586
               MACRF=(R),                                              X02587
               RECFM=F,                                                X02588
               KEYLEN=8,                                               X02589
               BLKSIZE=256,                                            X02590
               EXLST=JFCBAD,                                           X02591
               EODAD=PDSEOD,                                           X02592
               SYNAD=SYNADXIT                                           02593
         SPACE 8                                                        02594
PRINTDCB DCB   DDNAME=SYSPRINT,                                        X02595
               DSORG=PS,                                               X02596
               EROPT=ACC,                                              X02597
               MACRF=(PM),                                             X02598
               RECFM=FBM,                                              X02599
               LRECL=133,                                              X02600
               BLKSIZE=133                                              02601
         EJECT                                                          02602
OPENLIST OPEN  (VTOCDCB,(INPUT)),MF=L                                   02603
OPENFLAG EQU   OPENLIST                                                 02604
OPENUPDT EQU   X'04'                                                    02605
         SPACE 2                                                        02606
CLOSLIST CLOSE (VTOCDCB),MF=L                                           02607
CLOSFLAG EQU   CLOSLIST                                                 02608
CLOSRERD EQU   X'10'                                                    02609
         SPACE 2                                                        02610
         READ  VTOCDECB,SF,VTOCDCB,CAMLIST,MF=L                         02611
         SPACE 2                                                        02612
         READ  PDSDECB,SF,PDSDCB,MF=L                                   02613
         SPACE 2                                                        02614
ENQVTOC  RESERVE (SYSVTOC,VOLSERNO,S,6,SYSTEMS),UCB=UCBADDR,MF=L        02615
ENQFLAGS EQU   ENQVTOC+2                                                02616
ENQSHAR  EQU   X'80'                                                    02617
         SPACE 1                                                        02618
SYSVTOC  DC    CL8'SYSVTOC'                                             02619
         EJECT                                                          02620
DATEWORD DC    D'0'                                                     02621
CONVDEC  DC    D'0'                                                     02622
CONVEDIT DC    CL12' '                                                  02623
CONVERTD DC    CL11' ',C' '                                             02624
CONVUNPK DC    CL12' '                                                  02625
NOMAPDDS DC    C'JOBLIB  '                                              02626
         DC    C'STEPCAT '                P.A.S.                        02627
         DC    C'JOBCAT  '                P.A.S.                        02628
         DC    C'STEPLIB '                                              02629
         DC    C'SYSCHK  '                                              02630
         DC    C'PGM=*.DD'                                              02631
         DC    C'SYSIN   '                                              02632
         DC    C'SYSPRINT'                                              02633
         DC    C'SYSABEND'                                              02634
         DC    C'SYSUDUMP'                                              02635
         DC    C'        '                                              02636
VOLDDNAM DC    C'VOLUME00'                                              02637
         ORG   *-2                                                      02638
CURVOLNM DC    C'00'                                                    02639
TIME     DC    F'0'                                                     02640
PARMLIST DC    A(0)                                                     02641
DDNMLIST DC    A(0)                                                     02642
HDNGLIST DC    A(0)                                                     02643
DDLSTPTR DC    A(0)                                                     02644
         SPACE 1                                                        02645
EXTRACT  EQU   *                                                        02646
TIOTAD   DC    A(0)                                                     02647
COMPTR   DC    A(0)                                                     02648
         SPACE 1                                                        02649
TIOTADDD DC    A(0)                                                     02650
PDSBLKAD DC    A(PDSBLOCK,PDSBLOCK+PDSBLKLN)                            02651
CCHH     DC    F'0'                                                     02652
BUFPTR   DC    A(0)                                                     02653
HOOKSTRT DC    A(*)                                                     02654
HOOKEND  DC    F'-1'                                                    02655
DATNORMY DC    H'365',AL1(31,28,31,30,31,30,31,31,30,31,30,31)          02656
DATLEAPY DC    H'366',AL1(31,29,31,30,31,30,31,31,30,31,30,31)          02657
CORLEFT  DC    F'0'                                                     02658
CORNEXT@ DC    A(0)                                                     02659
CURBLK@  DC    A(*+4)                                                   02660
CORFRST@ DC    A(0)                                                     02661
CURLINES DC    H'999'                                                   02662
MAXPAGES DC    H'9999'                                                  02663
MAXLINES DC    H'58'                                                    02664
CURPAGES DC    H'0'                                                     02665
JFCBAD   DC    X'87',AL3(JFCB)                                          02666
VOLTAB   DC    F'0'                                                     02667
VOLSEEK  DC    F'0'                                                     02668
VOLSAMP  DC    F'3000'              NO. OF SAMPLES   (TEN MINUTES)      02669
VOLUCB   DC    F'0'                                                     02670
VOLTRKS  DC    F'0'                                                     02671
VOLSAVE  DC    15F'0'                                                   02672
SEEKCURR DC    F'0'                                                     02673
SEEKCYL  DC    F'0'                                                     02674
SEEKTRK  DC    F'0'                                                     02675
         DS    0D                                                       02676
INTERVL  DC    CL8'00000020'                                            02677
SEEKDBL  DC    2F'0'                                                    02678
SEEKTABL DC    193X'00',X'0A0B0C0D0E0F',41X'00'                         02679
         DC    X'00010203040506070809',6X'00'                           02680
DOUBCYL  DS    2F                                                       02681
DOUBTRK  DS    2F                                                       02682
SEEKPRT  DC    X'09',CL120' '                                           02683
SYSSEEK  DCB   DDNAME=SYSSEEK,DSORG=PS,RECFM=FB,LRECL=121,MACRF=(PM)    02684
SEEKEMSG DC    X'09',CL132'DEVICE NNN% BUSY, FOR NNNNN SAMPLES'         02685
SEEKBUF  DS    CL133                                                    02686
RETCODE  DC    F'0'                                                     02687
ABCODE   DC    F'100'              ABEND CODE 100                       02688
SAVEAREA DC    18F'0'                                                   02689
CURVOL   DC    H'0'                                                     02690
DDNAMLEN DC    H'0'                                                     02691
NUMVOLS  DC    H'-1'                                                    02692
NCPPARM  DC    AL2(NCPDFLT)                                             02693
TRAREA   DC    CL15' ',C' '                                             02694
EFFS     DC    44X'FF'                                                  02695
LASTDS1  EQU   EFFS                                                     02696
ZEROES   DC    44X'00'                                                  02697
PARMOPT1 DC    AL1(08)    SET DEFAULT TO NO OPTIONS                     02698
PARMOPT2 DC    AL1(0)                                                   02699
TRTABLE  EQU   *-240                                                    02700
         DC    C'0123456789ABCDEF'                                      02701
STARS    DC    C'*********'                                             02702
VOLSTAT  DC    X'00'                                                    02703
         DC    0F'0'                                                    02704
HOOKINIT DC    2XL4'00'                                                 02705
         DC    H'1'                                                     02706
         DC    X'FF00'                                                  02707
         DC    A(VOLABMSG)                                              02708
         DC    F'0'                                                     02709
         EJECT                                                          02710
         SPACE 3                                                        02711
DEVTABLE DC    X'06',CL15'2305-1 DISK'                                  02712
*                                                                       02713
         DC    X'07',CL15'2305-2 DISK'                                  02714
*                                                                       02715
         DC    X'08',CL15'2314 DISK PACK'                               02716
*                                                                       02717
         DC    X'09',CL15'3330 DISK PACK'                               02718
*                                                                       02719
         DC    X'0D',CL15'3330-II DISK'     ADDED 4/1/75  P.A.S.        02720
*                                                                       02721
         DC    X'0A',CL15'3340-35M DISK'   ADDED 5/4/75  P.A.S.         02722
*                                                                       02723
         DC    X'0B',CL15'3350 DISK PACK'  ADDED 01/10/77 G.D.F.        02724
*                                                                       02725
         DC    X'0E',CL15'3380 DISK PACK'  ADDED 06/14/82 G.D.F.        02726
*                                                                       02727
DEVTABND DC    X'00',CL7'UNKNOWN'                                       02728
         SPACE 1                                                        02729
DEVENTLN EQU   16                                                       02730
         EJECT                                                          02731
         LTORG                                                          02732
         SPACE 1                                                        02733
PCTLINE  DC    CL51'0====1====2====3====4====5====6====7====8====9====' 02734
VOLABMSG DC    CL44'  **** VOLUME LABEL ****'                           02735
VTOCMSG  DC    CL44'  **** VOLUME TABLE OF CONTENTS ****'               02736
FMT6MSG  DC    CL44'SPLIT CYLINDER(S) SHARED BY NEXT XXX EXTENTS'       02737
         SPACE 3                                                        02738
STORAGES DS    0D                                                       02739
         EJECT                                                          02740
BUF      DS    CL133                                                    02741
         SPACE 2                                                        02742
         ORG   BUF+1                                                    02743
L1       DS    0CL132                                                   02744
L1DSNAME DS    CL44                                                     02745
         DS    C                                                        02746
L1SERIAL DS    CL6                                                      02747
         DS    C                                                        02748
L1SECUR  DS    CL3                                                      02749
         DS    C                                                        02750
L1REFDT  DS    CL8                                                      02751
         DS    C                                                        02752
L1CREDT  DS    CL8                                                      02753
         DS    C                                                        02754
L1EXPDT  DS    CL8                                                      02755
         DS    C                                                        02756
L1DSORG  DS    CL3                                                      02757
         DS    C                                                        02758
L1RECFM  DS    CL3                                                      02759
         DS    C                                                        02760
L1BLKSIZ DS    CL5                                                      02761
         DS    C                                                        02762
L1LRECL  DS    CL5                                                      02763
         DS    C                                                        02764
L1KEYLEN DS    CL3                                                      02765
         DS    C                                                        02766
L1OPTCD  DS    CL2                                                      02767
         DS    C                                                        02768
L1TRKAL  DS    CL5                                                      02769
         DS    C                                                        02770
L1TRKUS  DS    CL5                                                      02771
         DS    C                                                        02772
L1NOEPV  DS    CL2                                                      02773
         DS    C                                                        02774
L1SECQU  DS    CL5                                                      02775
         DS    C                                                        02776
L1TYP    DS    CL1                                                      02777
         SPACE 1                                                        02778
         ORG   L1SERIAL                                                 02779
L1LSTDT  DS    CL8                                                      02780
         DS    C                                                        02781
L1USCNT  DS    CL5                                                      02782
         ORG   ,                                                        02783
         EJECT                                                          02784
PRSAVE   DS    5A                                                       02785
DASAVE   DS    5A                                                       02786
         DS    0D                                                       02787
PDSBLOCK DS    2XL(PDSBLKLN)                                            02788
CAMLIST  DS    XL(CAMLSTLN)                                             02789
         SPACE 1                                                        02790
START0   DS    0H                  START OF CORE ZEROED FOR EACH VOL    02791
         SPACE 1                                                        02792
DEVTYPE  DS    6F                                                       02793
UCBADDR  DS    A                                                        02794
FIRSTDS1 DS    A                                                        02795
FMT4AD   DS    A                                                        02796
FMT5AD   DS    A                                                        02797
FMT6AD   DS    A                                                        02798
FMT5TT   DS    H                                                        02799
FMT5CYLS DS    H                                                        02800
         SPACE 1                                                        02801
REBLOCK@ DS    F                                                        02802
RENEXT@  DS    F                                                        02803
REBLKSIZ DS    F                                                        02804
RECOUNT  DS    F                                                        02805
RENCP    DS    F                                                        02806
REGETSIZ DS    F                                                        02807
         SPACE 1                                                        02808
FMXCOUNT DS    0H                  COUNT FIELDS MUST BE TOGETHER        02809
FM0COUNT DS    H                                                        02810
FM1COUNT DS    H                                                        02811
FM2COUNT DS    H                                                        02812
FM3COUNT DS    H                                                        02813
FM4COUNT DS    H                                                        02814
FM5COUNT DS    H                                                        02815
FM6COUNT DS    H                                                        02816
         SPACE 1                                                        02817
AVAILCYL DS    H                                                        02818
AVAILSPC DS    H                                                        02819
AVAILEXT DS    H                                                        02820
VTOCSIZE DS    H                                                        02821
LOWTT    DS    H                                                        02822
HIGHTT   DS    H                                                        02823
         SPACE 1                                                        02824
HOOKPTR  DS    F                                                        02825
HOOKLCCH DS    XL4                                                      02826
HOOKHCCH DS    XL4                                                      02827
HOOKNTRK DS    H                                                        02828
HOOKTYPE DS    X                                                        02829
HOOKSEQN DS    X                                                        02830
HOOKIDPT DS    A                                                        02831
HOOKLOTT DS    XL2                                                      02832
HOOKHITT DS    XL2                                                      02833
         SPACE 1                                                        02834
F1TRKAL  DS    F                                                        02835
DEVTABPT DS    A                   POINTER TO CURRENT DEVTABLE ENTRY    02836
DEVCONV1 DS    H                   CURRENT DEVTABLE INFO                02837
DEVCONV2 DS    H                                                        02838
DEVCONV3 DS    H                                                        02839
DEVCONV4 DS    H                                                        02840
TRKSPCYL DS    H                                                        02841
TRKSPVOL DS    H                                                        02842
CRATRACK DS    H              REL TRACK ADDRESS OF VSAM CRA             02843
HWMOLD   DS    XL5                                                      02844
HWMDS1   DS    XL5                                                      02845
HWMNEW   DS    XL5                                                      02846
HWMINDIC DS    X                                                        02847
F5LARGST DS    XL3                                                      02848
SYNADFLG DS    X                                                        02849
OBCCHHR  DS    XL5                                                      02850
BADDSTYP DS    C                                                        02851
F5LARGTT DS    H                                                        02852
         SPACE 1                                                        02853
         DS    0H                                                       02854
VTOCTTR  DS    0XL3                                                     02855
VTOCTT   DS    H                                                        02856
VTOCR    DS    X                                                        02857
VTOCMBB  DS    0XL3                                                     02858
VTOCM    DS    X                                                        02859
VTOCBIN  DS    H                                                        02860
VTOCCCHH DS    XL4                                                      02861
VTDSCBTR DS    H                                                        02862
         SPACE 1                                                        02863
END0     DS    0H                  END OF CORE ZEROED FOR EACH VOL      02864
LENGTH0  EQU   END0-START0         AMOUNT TO BE ZEROED                  02865
         SPACE 1                                                        02866
NUMEXT   DS    H                                                        02867
LISTEXT  DS    17A                                                      02868
PDSAVE   DS    6A                                                       02869
PDSENTAD DS    A                                                        02870
PDSBYTCT DS    H                                                        02871
PDSBLKAL DS    H                                                        02872
PDSBLKUS DS    H                                                        02873
PDSMEMCT DS    H                                                        02874
ISAVE    DS    5A                                                       02875
EXPFLAG  DS    X                                                        02876
EXSAVE   DS    3A                                                       02877
VTSAVE   DS    4A                                                       02878
F1SAVE   DS    A                                                        02879
F5SAVE   DS    6A                                                       02880
HOSAVE   DS    4A                                                       02881
DUSAVE   DS    A                                                        02882
         EJECT ,                                                        02883
         IEFJFCBN                                                       02884
         SPACE 1                                                        02885
JFCB     EQU   INFMJFCB                                                 02886
         SPACE 3                                                        02887
         ORG   STORAGES                                                 02888
         EJECT                                                          02889
         SPACE 1                                                        02890
INIT     L     R2,0(R1)                                                 02891
         ST    R2,PARMLIST                                              02892
         LTR   R2,R2                                                    02893
         BM    GETTIME                                                  02894
         L     R2,4(R1)                                                 02895
         ST    R2,DDNMLIST                                              02896
         LTR   R2,R2                                                    02897
         BM    CHEKDDNM                                                 02898
         L     R2,8(R1)                                                 02899
         ST    R2,HDNGLIST                                              02900
         SPACE 1                                                        02901
         LA    R2,0(R2)                                                 02902
         LTR   R2,R2                                                    02903
         BZ    CHEKDDNM                                                 02904
         LH    R3,0(R2)                                                 02905
         LA    R2,2(R2)                                                 02906
         BAL   R14,PARMPARS                                             02907
         LTR   R0,R0                                                    02908
         BNP   CHEKDDNM                                                 02909
         CH    R0,=H'9999'                                              02910
         BH    CHEKDDNM                                                 02911
         BCTR  R0,0                                                     02912
         STH   R0,CURPAGES                                              02913
         MVI   HDNGLIST,X'FF'                                           02914
         SPACE 1                                                        02915
CHEKDDNM TM    PARMLIST,X'80'                                           02916
         BO    GETTIME                                                  02917
         L     R1,DDNMLIST                                              02918
         LH    R0,0(R1)                                                 02919
         SH    R0,=H'8'                                                 02920
         BM    GETTIME                                                  02921
         OI    DDNMLIST,X'F0'                                           02922
         STH   R0,DDNAMLEN                                              02923
         MVC   DCBDDNAM+(PRINTDCB-IHADCB),2(R1)                         02924
         SH    R0,=H'8'                                                 02925
         BM    GETTIME                                                  02926
         LA    R1,10(R1)                                                02927
         ST    R1,DDLSTPTR                                              02928
         OI    DDNMLIST,X'0F'                                           02929
         SPACE 1                                                        02930
GETTIME  TIME  DEC                                                      02931
         SRL   R0,4                                                     02932
         ST    R0,TIME                                                  02933
         MVC   PRTIME,=X'402120207A2020'                                02934
         ED    PRTIME,TIME                                              02935
         ST    R1,DATEWORD+4                                            02936
         UNPK  TRAREA,DATEWORD+6(8)                                     02937
         TR    TRAREA,TRTABLE                                           02938
         MVC   PRDAY,TRAREA                                             02939
         SR    R2,R2                                                    02940
         LA    R3,PRDATE                                                02941
         BAL   R14,DATEDIT                                              02942
         SPACE 1                                                        02943
         OPEN  (PRINTDCB,(OUTPUT))                                      02944
         TM    DCBOFLGS+(PRINTDCB-IHADCB),DCBOFOPN                      02945
         BNZ   *+8                                                      02946
         BAL   R14,ABEND                                                02947
         MVI   BUF,C' '                                                 02948
         MVC   BUF+1(L'BUF-1),BUF                                       02949
         SPACE 1                                                        02950
         EXTRACT EXTRACT,FIELDS=(TIOT,COMM)                             02951
         L     R1,TIOTAD                                                02952
         LA    R1,TIOENTRY-TIOT(,R1)                                    02953
         ST    R1,TIOTADDD                                              02954
         SPACE 1                                                        02955
         MVC   BUF+10(21),=C'EXEC PARAMETER FIELD:'                     02956
         L     R1,COMPTR                                                02957
         L     R1,COMCIBPT-COM(,R1)                                     02958
TESTCIB  LA    R1,0(,R1)                                                02959
         LTR   R1,R1                                                    02960
         B     PARMEX                AXC   NEVER CHECK CIB              02961
         BZ    PARMEX                AXC   NEVER CHECK CIB              02962
         USING CIB,R1                                                   02963
         CLI   CIBVERB,CIBSTART                                         02964
         BE    PARMCIB                                                  02965
         L     R1,CIBNEXT                                               02966
         B     TESTCIB                                                  02967
         SPACE 1                                                        02968
PARMCIB  LA    R1,CIBDATLN                                              02969
         ST    R1,PARMLIST                                              02970
         DROP  R1                                                       02971
         MVC   BUF+9(5),=C'START'                                       02972
         SPACE 1                                                        02973
PARMEX   L     R2,PARMLIST                                              02974
         LH    R3,0(R2)                                                 02975
         LA    R2,2(R2)                                                 02976
         CH    R3,=H'99'                                                02977
         BL    PARMLNOK                                                 02978
         MVC   BUF+30(28),=C' IS TOO LONG AND WAS IGNORED'              02979
         SR    R3,R3                                                    02980
         B     PARMPRNT                                                 02981
         SPACE 1                                                        02982
PARMLNOK LTR   R1,R3                                                    02983
         BZ    PARMPRNT                                                 02984
         BCTR  R1,0                                                     02985
         STC   R1,*+5                                                   02986
         MVC   BUF+33(*-*),0(R2)                                        02987
PARMPRNT MVI   BUF,SPACE3AP                                             02988
*        BAL   R14,PRINT                                                02989
         SPACE 1                                                        02990
PARMLOOP BAL   R14,PARMPARS                                             02991
         TM    PARMOPT2,VOLSOPT                                         02992
         BO    PARMVOL2                                                 02993
         TM    PARMOPT2,LNCNTOPT                                        02994
         BO    PARMLCT2                                                 02995
         TM    PARMOPT2,NCPOPT                                          02996
         BO    PARMNCP2                                                 02997
         CLI   PARMBUF,C' '                                             02998
         BE    PARMDONE                                                 02999
         SPACE 1                                                        03000
         LA    R0,12                                                    03001
         LA    R1,PARMS                                                 03002
PARMCOMP CLC   PARMBUF,0(R1)                                            03003
         BE    GOTPARM                                                  03004
         BXH   R1,R0,PARMCOMP                                           03005
         SPACE 1                                                        03006
GOTPARM  MVC   PARMVALS,8(R1)                                           03007
         MVC   *+8(2),10(R1)                                            03008
         B     *-*                                                      03009
         SPACE 1                                                        03010
PARMSET  SR    R15,R15                                                  03011
         IC    R15,PARMVALS+1                                           03012
         LA    R15,PARMOPT1(R15)                                        03013
         SR    R0,R0                                                    03014
         IC    R0,PARMVALS                                              03015
         CLI   PARMVALS,128                                             03016
         BH    PARMOFF                                                  03017
         STC   R0,*+5                                                   03018
         OI    0(R15),*-*                                               03019
         B     PARMLOOP                                                 03020
         SPACE 1                                                        03021
PARMOFF  STC   R0,*+5                                                   03022
         NI    0(R15),*-*                                               03023
         B     PARMLOOP                                                 03024
         SPACE 1                                                        03025
PDSON    L     R15,TIOTAD                                               03026
*        CLI   TIOCNJOB+3-TIOT(R15),C'$'    DELETED  4/1/75  P.A.S.     03027
*        BNE   PARMERR      DELETED  4/1/75   P.A.S.                    03028
         B     PARMSET                                                  03029
         SPACE 1                                                        03030
RESETON  NI    ENQFLAGS,255-ENQSHAR                                     03031
         OI    CLOSLIST,CLOSRERD                                        03032
         B     PARMSET                                                  03033
         SPACE 1                                                        03034
RESETOFF OI    ENQFLAGS,ENQSHAR                                         03035
         NI    CLOSLIST,255-CLOSRERD                                    03036
         B     PARMSET                                                  03037
         SPACE 1                                                        03038
PARMVOL2 NI    PARMOPT2,255-VOLSOPT                                     03039
         LTR   R0,R0                                                    03040
         BNP   PARMERR                                                  03041
         CH    R0,=H'99'                                                03042
         BH    PARMERR                                                  03043
         STH   R0,NUMVOLS                                               03044
         B     PARMLOOP                                                 03045
         SPACE 1                                                        03046
PARMLCT2 NI    PARMOPT2,255-LNCNTOPT                                    03047
         LTR   R0,R0                                                    03048
         BNP   PARMERR                                                  03049
         CH    R0,=H'999'                                               03050
         BNL   PARMERR                                                  03051
         STH   R0,MAXLINES                                              03052
         B     PARMLOOP                                                 03053
         SPACE 1                                                        03054
PARMNCP2 NI    PARMOPT2,255-NCPOPT                                      03055
         LTR   R0,R0                                                    03056
         BNP   PARMERR                                                  03057
         CH    R0,=H'99'                                                03058
         BH    PARMERR                                                  03059
         STH   R0,NCPPARM                                               03060
         B     PARMLOOP                                                 03061
         SPACE 1                                                        03062
PARMERR  MVI   BUF+10,C'"'                                              03063
         MVC   BUF+11(8),PARMBUF                                        03064
         MVC   BUF+19(41),=C'" IS AN ILLEGAL PARAMETER AND WAS IGNORED' 03065
         MVI   BUF,SPACE3AP                                             03066
*        BAL   R14,PRINT                                                03067
         B     PARMLOOP                                                 03068
         SPACE 1                                                        03069
PARMDONE OI    PARMOPT2,VOLSOPT                                         03070
         LH    R0,NUMVOLS                                               03071
         CH    R0,=H'-1'                                                03072
         BNE   PARMVOL#                                                 03073
         NI    PARMOPT2,255-VOLSOPT                                     03074
         MVC   NUMVOLS,=H'99'                                           03075
         MVC   BUF+10(3),=C'ALL'                                        03076
         B     PARMVLPR                                                 03077
         SPACE 1                                                        03078
PARMVOL# BAL   R14,CONVERT                                              03079
         MVC   BUF+10(3),CONVEDIT+9                                     03080
PARMVLPR MVC   BUF+14(24),=C'VOLUME(S) WILL BE LISTED'                  03081
         MVI   BUF,SPACE3AP                                             03082
*        BAL   R14,PRINT                                                03083
         SPACE 1                                                        03084
         CLC   NCPPARM,=H'1'                                            03085
         BNE   *+8                                                      03086
         OI    PARMOPT2,NCPOPT                                          03087
         TM    PARMOPT1,LSTDTOPT                                        03088
         BZ    PARMDDCK                                                 03089
         MVC   HEADAT1A(14),=C' LSTDT   USCNT'                          03090
         MVC   HEADAT1B(14),=C'________ _____'                          03091
         SPACE 1                                                        03092
PARMDDCK TM    DDNMLIST,X'F0'                                           03093
         BNO   PARMHDCK                                                 03094
         MVC   BUF+10(36),=C'AN INTERNAL DDNAME LIST WILL BE USED'      03095
         TM    DDNMLIST,X'0F'                                           03096
         BO    *+10                                                     03097
         MVC   BUF+47(14),=C'FOR PRINT ONLY'                            03098
         MVI   BUF,SPACE3AP                                             03099
*        BAL   R14,PRINT                                                03100
         SPACE 1                                                        03101
PARMHDCK CLI   HDNGLIST,X'FF'                                           03102
         BNE   PRTINFO      ADDED 4/1/75  P.A.S.  FOR 'HELP'            03103
         MVC   BUF+10(35),=C'AN INTERNAL PAGE COUNT WILL BE USED'       03104
         MVI   BUF,SPACE3AP                                             03105
*        BAL   R14,PRINT                                                03106
         SPACE 3                                                        03107
PRTINFO  EQU   *                                                        03108
         LA    R3,PRTINFOL  POINT TO INFO LISTING                       03109
         LA    R2,29    NUMBER OF LINES TO PRINT                        03110
PRTINFOA MVC   BUF+9(47),0(R3)  MOVE LINE TO BUFFER                     03111
         MVI   BUF,SPACE1AP   INSERT CARRIAGE CONTROL                   03112
         LA    R3,47(R3)  INCREMENT TO NEXT LINE                        03113
*        BAL   R14,PRINT                                                03114
         BCT   R2,PRTINFOA GO AGAIN                                     03115
         MVI   BUF,SPACE3IM                                             03116
*        BAL   R14,PRINT                                                03117
         MVC   BUF+9(33),=C'*** OPERATING SYSTEM RUN ON .... '          03118
         MVI   BUF,SPACE3AP                                             03119
         L     R3,16  POINT TO CVT                                      03120
         LA    R3,116(R3)   POINT TO OPERATING SYS                      03121
         TM    0(R3),X'40'  PCP                                         03122
         BNO   *+10                                                     03123
         MVC   BUF+42(4),=C'PCP '                                       03124
         TM    0(R3),X'20'  MFT                                         03125
         BNO   *+10                                                     03126
         MVC   BUF+42(4),=C'MFT '                                       03127
         TM    0(R3),X'10'  MVT                                         03128
         BNO   *+10                                                     03129
         MVC   BUF+42(4),=C'MP65'                                       03130
         TM    0(R3),X'22'  VS1                                         03131
         BNO   *+10                                                     03132
         MVC   BUF+42(4),=C'VS1 '                                       03133
         TM    0(R3),X'12'  VS2 REL 1 (SVS)                             03134
         BNO   *+10                                                     03135
         MVC   BUF+42(4),=C'SVS '                                       03136
         TM    0(R3),X'11'  VS2 REL 2+  (MVS)                           03137
         BNO   *+10                                                     03138
         MVC   BUF+42(4),=C'MVS '                                       03139
*        BAL   R14,PRINT                                                03140
         B     NEXTVOL                                                  03141
PRTINFOL DC    C'**********  EXECUTION  PARM  VALUES  **********'       03142
         DC    C'*                                             *'       03143
         DC    C'*  MAP.....PRODUCE A TRACK MAP OF VOLUME      *'       03144
         DC    C'*  SMAP....PRODUCE A TRACK MAP WITH SEEK INFO *'       03145
         DC    C'*  PDS.....LIST ALL PDS DIRECTORIES ON VOLUME *'       03146
         DC    C'*  ISAM....LIST ISAM REORG INFO FOR DATASETS  *'       03147
         DC    C'*  EXT.....LIST THE EXTENTS OF THE DATASETS   *'       03148
         DC    C'*  DUMP....LIST (HEX) ALL DSCB''S ON VOLUME   *'       03149
         DC    C'*  EMPTY...LIST ONLY DATASETS THAT ARE EMPTY  *'       03150
         DC    C'*  MODEL...WILL ONLY LIST "MODEL DSCB''S"     *'       03151
         DC    C'*  SDUMP...LIST (HEX) FORMAT 4 AND 5 DSCB''S  *'       03152
         DC    C'*  VOLS....ONLY USE DDNAMES OF "VOLUME--",    *'       03153
         DC    C'*      FORMAT--"VOLS=X", WHERE "X" IS MAX #   *'       03154
         DC    C'*  JDATE...LIST CREATE/EXPIRE DATE IN JULIAN  *'       03155
         DC    C'*                                             *'       03156
         DC    C'*  ALL DASD ALLOCATED TO STEP WILL BE LISTED  *'       03157
         DC    C'*  EXCEPT SYSTEM DD''S...SYS--, STEP--, ETC.  *'       03158
         DC    C'*  ***  DO NOT USE A DDNAME OF "SY000"  ***   *'       03159
         DC    C'*                                             *'       03160
         DC    C'*                                             *'       03161
         DC    C'*  STEPNAME SETS NO. OF SAMPLES FOR "SMAP"    *'       03162
         DC    C'*  STEPNAME FORMAT IS AS FOLLOWS -            *'       03163
         DC    C'*                                             *'       03164
         DC    C'*  SNNNN -                                    *'       03165
         DC    C'*      "NNNN"  IS THE NO. OF 1/5 SEC SAMPLES. *'       03166
         DC    C'*      IF "NNNN" IS NOT NUMERIC A DEFAULT OF  *'       03167
         DC    C'*      3000 SAMPLES WILL BE USED (10 MINUTES) *'       03168
         DC    C'*                                             *'       03169
         DC    C'***********************************************'       03170
         EJECT                                                          03171
         SPACE 3                                                        03172
PARMPARS SR    R0,R0                                                    03173
         MVC   PARMBUF,=CL8' '                                          03174
         LA    R4,PARMBUF                                               03175
         SPACE 1                                                        03176
PRMLOOK  CH    R3,=H'0'                                                 03177
         BNHR  R14                                                      03178
         CLI   0(R2),C' '                                               03179
         BE    PRMIGNOR                                                 03180
         CLI   0(R2),C','                                               03181
         BE    PRMRETRN                                                 03182
         CLI   0(R2),C'='                                               03183
         BE    PRMRETRN                                                 03184
         LTR   R0,R0                                                    03185
         BM    PRMNOT#                                                  03186
         TM    0(R2),X'F0'                                              03187
         BNO   PRMNOT#                                                  03188
         IC    R15,0(R2)                                                03189
         N     R15,=F'15'                                               03190
         CH    R15,=H'10'                                               03191
         BNL   PRMNOT#                                                  03192
         MH    R0,=H'10'                                                03193
         AR    R0,R15                                                   03194
         B     PRMSHIFT                                                 03195
         SPACE 1                                                        03196
PRMNOT#  LH    R0,=H'-1'                                                03197
PRMSHIFT C     R4,=A(PARMBUF+L'PARMBUF)                                 03198
         BNL   PRMIGNOR                                                 03199
         MVC   0(1,R4),0(R2)                                            03200
         LA    R4,1(R4)                                                 03201
PRMIGNOR LA    R2,1(R2)                                                 03202
         BCTR  R3,0                                                     03203
         B     PRMLOOK                                                  03204
         SPACE 1                                                        03205
PRMRETRN LA    R2,1(R2)                                                 03206
         BCTR  R3,0                                                     03207
         BR    R14                                                      03208
         EJECT ,                                                        03209
         SPACE 3                                                        03210
PARMS    DS    0H                                                       03211
         DC    C'LINECNT ',AL1(LNCNTOPT),AL1(1),S(PARMSET)              03212
         DC    C'NCP     ',AL1(NCPOPT),AL1(1),S(PARMSET)                03213
         DC    C'MODEL   ',AL1(MODELOPT),AL1(1),S(PARMSET)              03214
         DC    C'VOLS    ',AL1(VOLSOPT),AL1(1),S(PARMSET)               03215
         DC    C'EMPTY   ',AL1(EMPTYOPT),AL1(0),S(PARMSET)              03216
         DC    C'NOEMPTY ',AL1(255-EMPTYOPT),AL1(0),S(PARMSET)          03217
         DC    C'DUMP    ',AL1(DUMPOPT),AL1(0),S(PARMSET)               03218
         DC    C'NODUMP  ',AL1(255-DUMPOPT),AL1(0),S(PARMSET)           03219
         DC    C'EXT     ',AL1(EXTNTOPT),AL1(0),S(PARMSET)              03220
         DC    C'NOEXT   ',AL1(255-EXTNTOPT),AL1(0),S(PARMSET)          03221
         DC    C'ISAM    ',AL1(ISAMOPT),AL1(1),S(PARMSET)               03222
         DC    C'NOISAM  ',AL1(255-ISAMOPT),AL1(1),S(PARMSET)           03223
         DC    C'JDATE   ',AL1(JDATEOPT),AL1(1),S(PARMSET)              03224
         DC    C'NOJDATE ',AL1(255-JDATEOPT),AL1(1),S(PARMSET)          03225
         DC    C'LSTDT   ',AL1(LSTDTOPT),AL1(0),S(PARMSET)              03226
         DC    C'NOLSTDT ',AL1(255-LSTDTOPT),AL1(0),S(PARMSET)          03227
         DC    C'MAP     ',AL1(MAPOPT),AL1(0),S(PARMSET)                03228
         DC    C'NOMAP   ',AL1(255-MAPOPT),AL1(0),S(PARMSET)            03229
         DC    C'SMAP    ',AL1(SMAPOPT),AL1(1),S(PARMSET)               03230
         DC    C'NOSMAP  ',AL1(255-SMAPOPT),AL1(1),S(PARMSET)           03231
         DC    C'PDS     ',AL1(PDSOPT),AL1(0),S(PDSON)                  03232
         DC    C'NOPDS   ',AL1(255-PDSOPT),AL1(0),S(PARMSET)            03233
         DC    C'RESET   ',AL1(RESETOPT),AL1(1),S(RESETON)              03234
         DC    C'NORESET ',AL1(255-RESETOPT),AL1(1),S(RESETOFF)         03235
         DC    C'SDUMP   ',AL1(SDUMPOPT),AL1(0),S(PARMSET)              03236
         DC    C'NOSDUMP ',AL1(255-SDUMPOPT),AL1(0),S(PARMSET)          03237
PARMBUF  DC    C'        ',AL1(0),AL1(0),S(PARMERR)                     03238
         SPACE 1                                                        03239
PARMVALS DS    XL2                                                      03240
SYSTEMSW DS    X                                                        03241
         EJECT                                                          03242
         LTORG                                                          03243
         SPACE 1                                                        03244
         ORG   ,                                                        03245
         EJECT                                                          03246
UCB      DSECT                                                          03247
         IEFUCBOB                                                       03248
         EJECT                                                          03249
TIOT     DSECT                                                          03250
         IEFTIOT1                                                       03251
         EJECT                                                          03252
         SPACE 3                                                        03253
         DCBD  DSORG=BS,DEVD=DA                                         03254
         EJECT                                                          03255
         SPACE 3                                                        03256
DS1      DSECT                                                          03257
         IECSDSL1 (1)                                                   03258
DS1FDAD  DS    XL8                 FULL DA ADDRESS OF F1 DSCB           03259
DS1F3PTR DS    A                   @ OF F3 DSCB, IF ANY                 03260
DS1F1PTR DS    A                   @ OF NEXT F1 DSCB                    03261
DS1LEN   EQU   *-DS1                                                    03262
         SPACE 1                                                        03263
         ORG   DS1SYSCD-1                                               03264
DS1SECLV DS    XL1                                                      03265
         ORG   DS1SYSCD+13                                              03266
DS1LSTDT DS    XL3                                                      03267
DS1USCNT DS    XL2                                                      03268
         EJECT ,                                                        03269
         SPACE 3                                                        03270
DS2      DSECT                                                          03271
         IECSDSL1 (2)                                                   03272
DS2FDAD  DS    XL8                 FULL DA ADDRESS OF F2 DSCB           03273
DS2F3PTR DS    A                   POINTER TO FMT3 DSCB, IF ANY         03274
DS2LEN   EQU   *-DS2                                                    03275
         EJECT                                                          03276
         SPACE 3                                                        03277
DS3      DSECT                                                          03278
         IECSDSL1 (3)                                                   03279
DS3FDAD  DS    XL8                 FULL DA ADDRESS OF F3 DSCB           03280
DS3F2PTR DS    A                   POINTER TO FMT2 DSCB, IF ANY         03281
DS3LEN   EQU   *-DS3                                                    03282
         EJECT                                                          03283
         SPACE 3                                                        03284
DS4      DSECT                                                          03285
DS4KEYID DS    XL44                                                     03286
         IECSDSL1 (4)                                                   03287
DS4FDAD  DS    XL8                                                      03288
DS4LEN   EQU   *-DS4                                                    03289
*                                                                       03290
         ORG   DS4NOEXT+2                                               03291
DS4SECLV DS    XL1                 PRIV LEVEL REQ. FOR VTOC ACCESS      03292
         ORG   DS4DEVDB+9          VSAM OWNERSHIP BIT  X'80'            03293
DS4VSAM  DS    XL1                 USED TO PREVENT MULTIPLE OWNERS      03294
         EJECT                                                          03295
         SPACE 3                                                        03296
DS5      DSECT                                                          03297
         IECSDSL1 (5)                                                   03298
DS5FDAD  DS    XL8                                                      03299
DS5F5PTR DS    A                   @ OF NEXT F5 DSCB, IF ANY            03300
DS5LEN   EQU   *-DS5                                                    03301
         EJECT                                                          03302
         SPACE 3                                                        03303
DS6      DSECT                                                          03304
         IECSDSL1 (6)                                                   03305
DS6FDAD  DS    XL8                                                      03306
DS6F6PTR DS    A                                                        03307
DS6LEN   EQU   *-DS6                                                    03308
         EJECT                                                          03309
         SPACE 3                                                        03310
COM      DSECT                                                          03311
         IEZCOM                                                         03312
         EJECT ,                                                        03313
         SPACE 3                                                        03314
CIB      DSECT                                                          03315
         IEZCIB                                                         03316
         EJECT                                                          03317
         SPACE 1                                                        03318
EXTENT   DSECT                                                          03319
EXTPTR   DS    A                                                        03320
EXTLCCHH DS    XL4                                                      03321
EXTHCCHH DS    XL4                                                      03322
EXTNOTRK DS    H                                                        03323
EXTTYPE  DS    X                                                        03324
EXTSEQNO DS    X                                                        03325
EXTIDPTR DS    A                                                        03326
EXTLOTT  DS    XL2                                                      03327
EXTHITT  DS    XL2                                                      03328
EXTNTLEN EQU   *-EXTENT                                                 03329
         SPACE 1                                                        03330
EXLINE   DSECT                                                          03331
EXLLPARN DS    C                                                        03332
EXLFCC   DS    CL4                                                      03333
EXLFPRD  DS    C                                                        03334
EXLFHH   DS    CL4                                                      03335
         DS    2C                                                       03336
EXLLCC   DS    CL4                                                      03337
EXLLPRD  DS    C                                                        03338
EXLLHH   DS    CL4                                                      03339
         DS    2C                                                       03340
EXLFTT   DS    CL5                                                      03341
         DS    2C                                                       03342
EXLLTT   DS    CL5                                                      03343
         DS    2C                                                       03344
EXLNOTRK DS    CL5                                                      03345
EXLRPARN DS    C                                                        03346
         DS    C                                                        03347
EXLSEQNO DS    CL2                                                      03348
         DS    2C                                                       03349
EXLTYPE  DS    CL4                                                      03350
         DS    2C                                                       03351
EXLDSNAM DS    CL44                                                     03352
EXLSPLIT EQU   EXLDSNAM+33                                              03353
         SPACE 1                                                        03354
PDS      DSECT                                                          03355
PDSHKEY  DS    CL8                                                      03356
PDSCOUNT DS    H                                                        03357
         SPACE 1                                                        03358
PDSENTRY EQU   *                                                        03359
PDSNAME  DS    CL8                                                      03360
PDSTTRP  DS    XL3                                                      03361
PDSINDIC DS    B                                                        03362
PDSALIAS EQU   X'80'                                                    03363
PDS#TTRS EQU   X'60'                                                    03364
PDSUSERH EQU   X'1F'                                                    03365
PDSUSERD DS    0X                                                       03366
         SPACE 3                                                        03367
#PAN$AUD CSECT                                                          03368
$PAN#AUD DC    CL21'001CBT1016   04/04/89'                              03369
#PAN$AUD CSECT                                                          033694
$PAN#AUD DC    CL21'001CBT1016N  05/02/89'                              033695
         END   DISKSEEK                                                 03370
